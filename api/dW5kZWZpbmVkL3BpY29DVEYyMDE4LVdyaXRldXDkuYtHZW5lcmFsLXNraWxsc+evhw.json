{"title":"picoCTF2018 Writeup之General-skills篇","date":"2018-10-20T22:05:45.000Z","date_formatted":{"ll":"2018年10月20日","L":"2018/10/20","MM-DD":"10-20"},"link":"undefined/picoCTF2018-Writeup之General-skills篇","tags":["CTF"],"updated":"2020-12-27T16:45:50.787Z","content":"<p>旧文搬运，原文地址:<a href=\"https://xz.aliyun.com/t/2921\">https://xz.aliyun.com/t/2921</a></p>\n<h1 id=\"前言\">前言<a title=\"#前言\" href=\"#前言\"></a></h1>\n<p>接上篇，General-skills部分主要是一些linux命令的使用和小tricks。部分题目文件已打包为附件。</p>\n<a id=\"more\"></a>\n<h1 id=\"general-warmup-1-2-3\">General Warmup 1 2 3<a title=\"#general-warmup-1-2-3\" href=\"#general-warmup-1-2-3\"></a></h1>\n<h2 id=\"question\">Question<a title=\"#question\" href=\"#question\"></a></h2>\n<blockquote>\n<p>If I told you your grade was 0x41 in hexadecimal, what would it be in ASCII?</p>\n</blockquote>\n<blockquote>\n<p>Can you convert the number 27 (base 10) to binary (base 2)?</p>\n</blockquote>\n<blockquote>\n<p>What is 0x3D (base 16) in decimal (base 10).</p>\n</blockquote>\n<h1 id=\"solution\">Solution<a title=\"#solution\" href=\"#solution\"></a></h1>\n<p>三题签到题，差不多一个意思，就放一起了。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;&gt; chr(0x41)</span><br><span class=\"line\"><span class=\"string\">&#x27;A&#x27;</span></span><br><span class=\"line\">&gt;&gt;&gt; bin(27)[2:]</span><br><span class=\"line\"><span class=\"string\">&#x27;11011&#x27;</span></span><br><span class=\"line\">&gt;&gt;&gt; 0x3d</span><br><span class=\"line\">61</span><br></pre></td></tr></table></figure>\n<p>flag:</p>\n<ul>\n<li><code>picoCTF&#123;A&#125;</code></li>\n<li><code>picoCTF&#123;11011&#125;</code></li>\n<li><code>picoCTF&#123;61&#125;</code></li>\n</ul>\n<h1 id=\"resources\">Resources<a title=\"#resources\" href=\"#resources\"></a></h1>\n<h2 id=\"question-1\">Question<a title=\"#question-1\" href=\"#question-1\"></a></h2>\n<blockquote>\n<p>We put together a bunch of resources to help you out on our website! If you go over there, you might even find a flag! <a href=\"https://picoctf.com/resources\" target=\"_blank\">https://picoctf.com/resources</a> (<a href=\"https://picoctf.com/resources\" target=\"_blank\">link</a>)</p>\n</blockquote>\n<h3 id=\"hint\">Hint<a title=\"#hint\" href=\"#hint\"></a></h3>\n<p>No hints available</p>\n<h2 id=\"solution-1\">Solution<a title=\"#solution-1\" href=\"#solution-1\"></a></h2>\n<p>打开网页下拉，就能看到flag</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Thanks for reading the resources page! Here’s a flag for your time: picoCTF&#123;xiexie_ni_lai_zheli&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code> picoCTF&#123;xiexie_ni_lai_zheli&#125;</code></p>\n<h1 id=\"grep-1\">Grep 1<a title=\"#grep-1\" href=\"#grep-1\"></a></h1>\n<h2 id=\"question-2\">Question<a title=\"#question-2\" href=\"#question-2\"></a></h2>\n<blockquote>\n<p>Can you find the flag in <a href=\"https://2018shell2.picoctf.com/static/7216e49d925b623c5d2cf9d141a6e180/file\" target=\"_blank\">file</a>? This would be really obnoxious to look through by hand, see if you can find a faster way. You can also find the file in /problems/grep-1_3_8d9cff3d178c231ab735dfef3267a1c2 on the shell server.</p>\n</blockquote>\n<h3 id=\"hint-1\">Hint<a title=\"#hint-1\" href=\"#hint-1\"></a></h3>\n<blockquote>\n<p>grep <a href=\"https://ryanstutorials.net/linuxtutorial/grep.php\" target=\"_blank\">tutorial</a></p>\n</blockquote>\n<h2 id=\"solution-2\">Solution<a title=\"#solution-2\" href=\"#solution-2\"></a></h2>\n<p><code>grep</code>，(global search regular expression(RE) and print out the line,全面搜索正则表达式并把行打印出来)是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。</p>\n<p><code>cat file</code>会有一大堆乱码字符，使用<code>grep picoCTF file</code>可以把flag从乱码中提取出来。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/grep-1_2_ee2b29d2f2b29c65db957609a3543418$ grep picoCTF file              </span><br><span class=\"line\">picoCTF&#123;grep_and_you_will_find_42783683&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"net-cat\">net cat<a title=\"#net-cat\" href=\"#net-cat\"></a></h1>\n<h2 id=\"question-3\">Question<a title=\"#question-3\" href=\"#question-3\"></a></h2>\n<blockquote>\n<p>Using netcat (nc) will be a necessity throughout your adventure. Can you connect to <code>2018shell1.picoctf.com</code> at port <code>49387</code> to get the flag?</p>\n</blockquote>\n<h3 id=\"hint-2\">Hint<a title=\"#hint-2\" href=\"#hint-2\"></a></h3>\n<p>nc <a href=\"https://linux.die.net/man/1/nc\" target=\"_blank\">tutorial</a></p>\n<h2 id=\"solution-3\">Solution<a title=\"#solution-3\" href=\"#solution-3\"></a></h2>\n<p><code>nc</code>是一个简单、可靠的网络工具，可通过TCP或UDP协议传输读写数据。</p>\n<p>通过nc连接题目的服务器得到flag。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">❯ nc 2018shell2.picoctf.com 36356</span><br><span class=\"line\">That wasn<span class=\"string\">&#x27;t so hard was it?</span></span><br><span class=\"line\"><span class=\"string\">picoCTF&#123;NEtcat_iS_a_NEcESSiTy_9454f3e0&#125;</span></span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;NEtcat_iS_a_NEcESSiTy_9454f3e0&#125;</code></p>\n<h1 id=\"pipe\">pipe<a title=\"#pipe\" href=\"#pipe\"></a></h1>\n<h2 id=\"question-4\">Question<a title=\"#question-4\" href=\"#question-4\"></a></h2>\n<blockquote>\n<p>During your adventure, you will likely encounter a situation where you need to process data that you receive over the network rather than through a file. Can you find a way to save the output from this program and search for the flag? Connect with <code>2018shell1.picoctf.com 48696</code>.</p>\n</blockquote>\n<h3 id=\"hint-3\">Hint<a title=\"#hint-3\" href=\"#hint-3\"></a></h3>\n<blockquote>\n<p>Remember the flag format is picoCTF{XXXX}</p>\n<p>Ever heard of a pipe? No not that kind of pipe… This <a href=\"http://www.linfo.org/pipes.html\" target=\"_blank\">kind</a></p>\n</blockquote>\n<h2 id=\"solution-4\">Solution<a title=\"#solution-4\" href=\"#solution-4\"></a></h2>\n<p><strong>管道命令</strong>操作符是：<code>|</code>,它能处理经由前面一个指令传出的正确输出信息，也就是 standard output 的信息，然后作为标准的输入 standard input，传递给下一个命令。</p>\n<p>连接服务器，配合<code>grep</code>得到flag。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">❯ nc 2018shell2.picoctf.com 34532 |grep picoCTF</span><br><span class=\"line\">picoCTF&#123;almost_like_mario_b797f2b3&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;almost_like_mario_b797f2b3&#125;</code></p>\n<h1 id=\"strings\">Strings<a title=\"#strings\" href=\"#strings\"></a></h1>\n<h2 id=\"question-5\">Question<a title=\"#question-5\" href=\"#question-5\"></a></h2>\n<blockquote>\n<p>Can you find the flag in this <a href=\"https://2018shell2.picoctf.com/static/a3d311b507256d5d9299c0e94dfc4fc5/strings\" target=\"_blank\">file</a> without actually running it? You can also find the file in /problems/strings_2_b7404a3aee308619cb2ba79677989960 on the shell server.</p>\n</blockquote>\n<h3 id=\"hint-4\">Hint<a title=\"#hint-4\" href=\"#hint-4\"></a></h3>\n<blockquote>\n<p><a href=\"https://linux.die.net/man/1/strings\" target=\"_blank\">strings</a></p>\n</blockquote>\n<h2 id=\"solution-5\">Solution<a title=\"#solution-5\" href=\"#solution-5\"></a></h2>\n<p><code>strings</code>命令可以打印文件中可打印的字符，使用<code>strings</code>命令配合<code>grep</code>命令可以把flag提取出来。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/strings_4_40d221755b4a0b134c2a7a2e825ef95f$ strings strings |grep picoCTF    </span><br><span class=\"line\">picoCTF&#123;sTrIngS_sAVeS_Time_d3ffa29c&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;sTrIngS_sAVeS_Time_d3ffa29c&#125;</code></p>\n<h1 id=\"grep-2\">grep 2<a title=\"#grep-2\" href=\"#grep-2\"></a></h1>\n<h2 id=\"question-6\">Question<a title=\"#question-6\" href=\"#question-6\"></a></h2>\n<blockquote>\n<p>This one is a little bit harder. Can you find the flag in /problems/grep-2_3_826f886f547acb8a9c3fccb030e8168d/files on the shell server? Remember, grep is your friend.</p>\n</blockquote>\n<h3 id=\"hint-5\">Hint<a title=\"#hint-5\" href=\"#hint-5\"></a></h3>\n<blockquote>\n<p>grep <a href=\"https://ryanstutorials.net/linuxtutorial/grep.php\" target=\"_blank\">tutorial</a></p>\n</blockquote>\n<h2 id=\"solution-6\">Solution<a title=\"#solution-6\" href=\"#solution-6\"></a></h2>\n<p>目录下有许多个文件夹，每个文件夹下面又有文件夹和文件。可以使用<code>grep -r</code>选项来递归的搜寻文件。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/grep-2_3_826f886f547acb8a9c3fccb030e8168d/files$ grep -r picoCTF             </span><br><span class=\"line\">files2/file20:picoCTF&#123;grep_r_and_you_will_find_556620f7&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;grep_r_and_you_will_find_556620f7&#125;</code></p>\n<h1 id=\"aca-shell-a\">Aca-Shell-A<a title=\"#aca-shell-a\" href=\"#aca-shell-a\"></a></h1>\n<h2 id=\"question-7\">Question<a title=\"#question-7\" href=\"#question-7\"></a></h2>\n<blockquote>\n<p>It’s never a bad idea to brush up on those linux skills or even learn some new ones before you set off on this adventure! Connect with <code>nc 2018shell1.picoctf.com 27833</code>.</p>\n</blockquote>\n<h3 id=\"hint-6\">Hint<a title=\"#hint-6\" href=\"#hint-6\"></a></h3>\n<blockquote>\n<p>Linux for <a href=\"https://maker.pro/education/basic-linux-commands-for-beginners\" target=\"_blank\">Beginners</a></p>\n</blockquote>\n<h2 id=\"solution-7\">Solution<a title=\"#solution-7\" href=\"#solution-7\"></a></h2>\n<p>这题用到了以下的基础linux命令：</p>\n<ul>\n<li><code>ls</code></li>\n<li><code>cd</code></li>\n<li><code>rm</code></li>\n<li><code>whoami</code></li>\n<li><code>cat</code></li>\n<li>如何执行二进制可执行文件</li>\n</ul>\n<p>依照指示输入命令就可以了。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ nc 2018shell1.picoctf.com 27833</span><br><span class=\"line\">Sweet! We have gotten access into the system but we aren<span class=\"string\">&#x27;t root.</span></span><br><span class=\"line\"><span class=\"string\">It&#x27;</span>s some sort of restricted shell! I can<span class=\"string\">&#x27;t see what you are typing</span></span><br><span class=\"line\"><span class=\"string\">but I can see your output. I&#x27;</span>ll be here to <span class=\"built_in\">help</span> you along.</span><br><span class=\"line\">If you need <span class=\"built_in\">help</span>, <span class=\"built_in\">type</span> <span class=\"string\">&quot;echo &#x27;Help Me!&#x27;&quot;</span> and I<span class=\"string\">&#x27;ll see what I can do</span></span><br><span class=\"line\"><span class=\"string\">There is not much time left!</span></span><br><span class=\"line\"><span class=\"string\">~/$ ls</span></span><br><span class=\"line\"><span class=\"string\">blackmail</span></span><br><span class=\"line\"><span class=\"string\">executables</span></span><br><span class=\"line\"><span class=\"string\">passwords</span></span><br><span class=\"line\"><span class=\"string\">photos</span></span><br><span class=\"line\"><span class=\"string\">secret</span></span><br><span class=\"line\"><span class=\"string\">~/$ cd secret</span></span><br><span class=\"line\"><span class=\"string\">Now we are cookin&#x27;</span>! Take a look around there and tell me what you find!</span><br><span class=\"line\">~/secret$ ls</span><br><span class=\"line\">intel_1</span><br><span class=\"line\">intel_2</span><br><span class=\"line\">intel_3</span><br><span class=\"line\">intel_4</span><br><span class=\"line\">intel_5</span><br><span class=\"line\">profile_AipieG5Ua9aewei5ieSoh7aph</span><br><span class=\"line\">profile_Xei2uu5suwangohceedaifohs</span><br><span class=\"line\">profile_ahShaighaxahMooshuP1johgo</span><br><span class=\"line\">profile_ahqueith5aekongieP4ahzugi</span><br><span class=\"line\">profile_aik4hah9ilie9foru0Phoaph0</span><br><span class=\"line\">profile_bah9Ech9oa4xaicohphahfaiG</span><br><span class=\"line\">profile_ie7sheiP7su2At2ahw6iRikoe</span><br><span class=\"line\">profile_of0Nee4laith8odaeLachoonu</span><br><span class=\"line\">profile_poh9eij4Choophaweiwev6eev</span><br><span class=\"line\">profile_poo3ipohGohThi9Cohverai7e</span><br><span class=\"line\">Sabatoge them! Get rid of all their intel files!</span><br><span class=\"line\">~/secret$ rm intel*</span><br><span class=\"line\">Nice! Once they are all gone, I think I can drop you a file of an exploit!</span><br><span class=\"line\">Just <span class=\"built_in\">type</span> <span class=\"string\">&quot;echo &#x27;Drop it in!&#x27; &quot;</span> and we can give it a whirl!</span><br><span class=\"line\">~/secret$ <span class=\"built_in\">echo</span> <span class=\"string\">&#x27;Drop it in!&#x27;</span></span><br><span class=\"line\">Drop it <span class=\"keyword\">in</span>!</span><br><span class=\"line\">I placed a file <span class=\"keyword\">in</span> the executables folder as it looks like the only place we can execute from!</span><br><span class=\"line\">Run the script I wrote to have a little more impact on the system!</span><br><span class=\"line\">~/secret$ <span class=\"built_in\">cd</span> ..</span><br><span class=\"line\">~/$ <span class=\"built_in\">cd</span> executables</span><br><span class=\"line\">~/executables$ ls  </span><br><span class=\"line\">dontLookHere</span><br><span class=\"line\">~/executables$ ./dontLookHere</span><br><span class=\"line\">...</span><br><span class=\"line\">...</span><br><span class=\"line\">...</span><br><span class=\"line\">Looking through the text above, I think I have found the password. I am just having trouble with a username.</span><br><span class=\"line\">Oh drats! They are onto us! We could get kicked out soon!</span><br><span class=\"line\">Quick! Print the username to the screen so we can close are backdoor and <span class=\"built_in\">log</span> into the account directly!</span><br><span class=\"line\">You have to find another way other than <span class=\"built_in\">echo</span>!</span><br><span class=\"line\">~/executables$ whoami</span><br><span class=\"line\">l33th4x0r</span><br><span class=\"line\">Perfect! One second!</span><br><span class=\"line\">Okay, I think I have got what we are looking <span class=\"keyword\">for</span>. I just need to to copy the file to a place we can <span class=\"built_in\">read</span>.</span><br><span class=\"line\">Try copying the file called TopSecret <span class=\"keyword\">in</span> tmp directory into the passwords folder.</span><br><span class=\"line\">~/executables$ cp /tmp/TopSecret passwords</span><br><span class=\"line\">Server shutdown <span class=\"keyword\">in</span> 10 seconds...</span><br><span class=\"line\">Quick! go <span class=\"built_in\">read</span> the file before we lose our connection!</span><br><span class=\"line\">~/executables$ <span class=\"built_in\">cd</span> ..</span><br><span class=\"line\">~/$ ls</span><br><span class=\"line\">blackmail</span><br><span class=\"line\">executables</span><br><span class=\"line\">passwords</span><br><span class=\"line\">photos</span><br><span class=\"line\">secret</span><br><span class=\"line\">~/$ <span class=\"built_in\">cd</span> passwords</span><br><span class=\"line\">~/passwords$ ls</span><br><span class=\"line\">TopSecret</span><br><span class=\"line\">~/passwords$ cat TopSecret</span><br><span class=\"line\">Major General John M. Schofield<span class=\"string\">&#x27;s graduation address to the graduating class of 1879 at West Point is as follows: The discipline which makes the soldiers of a free country reliable in battle is not to be gained by harsh or tyrannical treatment.On the contrary, such treatment is far more likely to destroy than to make an army.It is possible to impart instruction and give commands in such a manner and such a tone of voice as to inspire in the soldier no feeling butan intense desire to obey, while the opposite manner and tone of voice cannot fail to excite strong resentment and a desire to disobey.The one mode or other of dealing with subordinates springs from a corresponding spirit in the breast of the commander.He who feels the respect which is due to others, cannot fail to inspire in them respect for himself, while he who feels,and hence manifests disrespect towards others, especially his subordinates, cannot fail to inspire hatred against himself.</span></span><br><span class=\"line\"><span class=\"string\">picoCTF&#123;CrUsHeD_It_9edaa84a&#125;</span></span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;CrUsHeD_It_9edaa84a&#125;</code></p>\n<h1 id=\"environ\">environ<a title=\"#environ\" href=\"#environ\"></a></h1>\n<h2 id=\"question-8\">Question<a title=\"#question-8\" href=\"#question-8\"></a></h2>\n<blockquote>\n<p>Sometimes you have to configure environment variables before executing a program. Can you find the flag we’ve hidden in an environment variable on the shell server?</p>\n</blockquote>\n<h3 id=\"hint-7\">Hint<a title=\"#hint-7\" href=\"#hint-7\"></a></h3>\n<blockquote>\n<p>unix <a href=\"https://www.tutorialspoint.com/unix/unix-environment.htm\" target=\"_blank\">env</a></p>\n</blockquote>\n<h2 id=\"solution-8\">Solution<a title=\"#solution-8\" href=\"#solution-8\"></a></h2>\n<p>考察linux系统环境变量，使用<code>env</code>命令可以列出系统中所有的环境变量，配合<code>grep</code>命令得到flag。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/grep-2_3_826f886f547acb8a9c3fccb030e8168d/files$ env|grep pico               </span><br><span class=\"line\">SECRET_FLAG=picoCTF&#123;eNv1r0nM3nT_v4r14Bl3_fL4g_3758492&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;eNv1r0nM3nT_v4r14Bl3_fL4g_3758492&#125;</code></p>\n<h1 id=\"ssh-keyz\">ssh-keyz<a title=\"#ssh-keyz\" href=\"#ssh-keyz\"></a></h1>\n<h2 id=\"question-9\">Question<a title=\"#question-9\" href=\"#question-9\"></a></h2>\n<blockquote>\n<p>As nice as it is to use our webshell, sometimes its helpful to connect directly to our machine. To do so, please add your own public key to ~/.ssh/authorized_keys, using the webshell. The flag is in the ssh banner which will be displayed when you login remotely with ssh to with your username.</p>\n</blockquote>\n<h3 id=\"hint-8\">Hint<a title=\"#hint-8\" href=\"#hint-8\"></a></h3>\n<blockquote>\n<p>key generation <a href=\"https://confluence.atlassian.com/bitbucketserver/creating-ssh-keys-776639788.html\" target=\"_blank\">tutorial</a></p>\n<p>We also have an expert demonstrator to help you along. <a href=\"https://www.youtube.com/watch?v=3CN65ccfllU&amp;list=PLJ_vkrXdcgH-lYlRV8O-kef2zWvoy79yP&amp;index=4\" target=\"_blank\">link</a></p>\n</blockquote>\n<h2 id=\"solution-9\">Solution<a title=\"#solution-9\" href=\"#solution-9\"></a></h2>\n<p>公钥连接服务器相关，在shell服务器中使用<code>ssh-keygen -t rsa</code>生成自己的公私钥对，默认生成为*~/.ssh/id_rsa.pub*(公钥)和*~/.ssh/id_rsa*（私钥），将私钥下载到本地，然后用<code>ssh &lt;username&gt;@2018shell2.picoctf.com</code>连接服务器即可在欢迎信息的banner中看到flag。</p>\n<p>这题也可以直接查看banner文件。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:~$ cat /etc/ssh/sshd_config |grep banner                                               </span><br><span class=\"line\">Banner /opt/ssh_banner</span><br><span class=\"line\">finn@pico-2018-shell-2:~$ cat /opt/ssh_banner                                                                 </span><br><span class=\"line\">picoCTF&#123;who_n33ds_p4ssw0rds_38dj21&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;who_n33ds_p4ssw0rds_38dj21&#125;</code></p>\n<h1 id=\"what-base-is-this?\">what base is this?<a title=\"#what-base-is-this?\" href=\"#what-base-is-this?\"></a></h1>\n<h2 id=\"question-10\">Question<a title=\"#question-10\" href=\"#question-10\"></a></h2>\n<blockquote>\n<p>To be successful on your mission, you must be able read data represented in different ways, such as hexadecimal or binary. Can you get the flag from this program to prove you are ready? Connect with <code>nc 2018shell1.picoctf.com 1225</code>.</p>\n</blockquote>\n<h3 id=\"hint-9\">Hint<a title=\"#hint-9\" href=\"#hint-9\"></a></h3>\n<blockquote>\n<p>I hear python is a good means (among many) to convert things.</p>\n<p>It might help to have multiple windows open</p>\n</blockquote>\n<h2 id=\"solution-10\">Solution<a title=\"#solution-10\" href=\"#solution-10\"></a></h2>\n<p>三个不通的进制转换，分别是二进制、十六进制和八进制，转换为十进制，然后发送对应ascii码的单词，写个脚本处理一下就可以了。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">&#x27;2018shell2.picoctf.com&#x27;</span>, <span class=\"number\">31711</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">binary = r.recvuntil(<span class=\"string\">&#x27;as a word.&#x27;</span>)</span><br><span class=\"line\">binary = re.findall(<span class=\"string\">r&#x27;(\\d+)&#x27;</span>, binary)</span><br><span class=\"line\">binary_word = <span class=\"string\">&#x27;&#x27;</span>.join([<span class=\"built_in\">chr</span>(<span class=\"built_in\">int</span>(i, <span class=\"number\">2</span>)) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> binary])</span><br><span class=\"line\">r.sendline(binary_word)</span><br><span class=\"line\"></span><br><span class=\"line\">hexnum = r.recvuntil(<span class=\"string\">&#x27;as a word.&#x27;</span>)</span><br><span class=\"line\">hexnum = re.findall(<span class=\"string\">r&#x27;([0-9a-f]+) as&#x27;</span>, hexnum)[<span class=\"number\">0</span>]</span><br><span class=\"line\">hexword = hexnum.decode(<span class=\"string\">&#x27;hex&#x27;</span>)</span><br><span class=\"line\">r.sendline(hexword)</span><br><span class=\"line\"></span><br><span class=\"line\">octal = r.recvuntil(<span class=\"string\">&#x27;as a word.&#x27;</span>)</span><br><span class=\"line\">octal = re.findall(<span class=\"string\">r&#x27;([0-9]+)&#x27;</span>, octal)</span><br><span class=\"line\">octal_word = <span class=\"string\">&#x27;&#x27;</span>.join([<span class=\"built_in\">chr</span>(<span class=\"built_in\">int</span>(i, <span class=\"number\">8</span>)) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> octal])</span><br><span class=\"line\">r.sendline(octal_word)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span> r.recvuntil(<span class=\"string\">&#x27;&#125;\\n&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">r.close()</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ python nc_convert.py</span><br><span class=\"line\">[+] Opening connection to 2018shell2.picoctf.com on port 31711: Done</span><br><span class=\"line\"></span><br><span class=\"line\">Input:</span><br><span class=\"line\">You got it! You<span class=\"string\">&#x27;re super quick!</span></span><br><span class=\"line\"><span class=\"string\">Flag: picoCTF&#123;delusions_about_finding_values_68051dea&#125;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[*] Closed connection to 2018shell2.picoctf.com port 31711</span></span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;delusions_about_finding_values_68051dea&#125;</code></p>\n<h1 id=\"you-can't-see-me\">you can’t see me<a title=\"#you-can't-see-me\" href=\"#you-can't-see-me\"></a></h1>\n<h2 id=\"question-11\">Question<a title=\"#question-11\" href=\"#question-11\"></a></h2>\n<blockquote>\n<p>‘…reading transmission… Y.O.U. .C.A.N.’.T. .S.E.E. .M.E. …transmission ended…’ Maybe something lies in /problems/you-can-t-see-me_3_1a39ec6c80b3f3a18610074f68acfe69.</p>\n</blockquote>\n<h3 id=\"hint-10\">Hint<a title=\"#hint-10\" href=\"#hint-10\"></a></h3>\n<blockquote>\n<p>What command can see/read files?</p>\n<p>What’s in the manual page of ls?</p>\n</blockquote>\n<h2 id=\"solution-11\">Solution<a title=\"#solution-11\" href=\"#solution-11\"></a></h2>\n<p><code>ls -a</code>可以查看以<code>.</code>开头的隐藏文件。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/you-can-t-see-me_2_cfb71908d8368e3062423b45959784aa$ ls -a                   </span><br><span class=\"line\">.  .    ..</span><br></pre></td></tr></table></figure>\n<p>其中一个<code>.</code>代表当前目录，另一个是一个文件，直接<code>cat .</code>会显示</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/you-can-t-see-me_2_cfb71908d8368e3062423b45959784aa$ cat .                   </span><br><span class=\"line\">cat: .: Is a directory </span><br></pre></td></tr></table></figure>\n<p>输入<code>cat</code>然后用tab键补全就能看到真正的文件名了，是一个<code>.</code>和两个<code>空格</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/you-can-t-see-me_2_cfb71908d8368e3062423b45959784aa$ cat .\\ \\                </span><br><span class=\"line\">picoCTF&#123;j0hn_c3na_paparapaaaaaaa_paparapaaaaaa_093d6aff&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;j0hn_c3na_paparapaaaaaaa_paparapaaaaaa_093d6aff&#125;</code></p>\n<h1 id=\"absolutely-relative\">absolutely relative<a title=\"#absolutely-relative\" href=\"#absolutely-relative\"></a></h1>\n<h2 id=\"question-12\">Question<a title=\"#question-12\" href=\"#question-12\"></a></h2>\n<blockquote>\n<p>In a filesystem, everything is relative ¯_(ツ)_/¯. Can you find a way to get a flag from this <a href=\"https://2018shell2.picoctf.com/static/3a286144f1c251a493c223d6a8ff0a6d/absolutely-relative\" target=\"_blank\">program</a>? You can find it in /problems/absolutely-relative_1_15eb86fcf5d05ec169cc417d24e02c87 on the shell server. <a href=\"https://2018shell2.picoctf.com/static/3a286144f1c251a493c223d6a8ff0a6d/absolutely-relative.c\" target=\"_blank\">Source</a>.</p>\n</blockquote>\n<h3 id=\"hint-11\">Hint<a title=\"#hint-11\" href=\"#hint-11\"></a></h3>\n<blockquote>\n<p>Do you have to run the program in the same directory? (⊙.☉)7</p>\n<p>Ever used a text editor? Check out the program ‘nano’</p>\n</blockquote>\n<h2 id=\"solution-12\">Solution<a title=\"#solution-12\" href=\"#solution-12\"></a></h2>\n<p>阅读程序源码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;                                                                                            </span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;                                                                                           </span></span></span><br><span class=\"line\">                                                                                                              </span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> yes_len 3                                                                                             </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *yes = <span class=\"string\">&quot;yes&quot;</span>;                                                                                      </span><br><span class=\"line\">                                                                                                              </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span>                                                                                                    </span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;                                                                                                             </span><br><span class=\"line\">    <span class=\"keyword\">char</span> flag[<span class=\"number\">99</span>];                                                                                            </span><br><span class=\"line\">    <span class=\"keyword\">char</span> permission[<span class=\"number\">10</span>];                                                                                      </span><br><span class=\"line\">    <span class=\"keyword\">int</span> i;                                                                                                    </span><br><span class=\"line\">    FILE * file;                                                                                              </span><br><span class=\"line\">                                                                                                              </span><br><span class=\"line\">                                                                                                              </span><br><span class=\"line\">    file = fopen(<span class=\"string\">&quot;/problems/absolutely-relative_0_d4f0f1c47f503378c4bb81981a80a9b6/flag.txt&quot;</span> , <span class=\"string\">&quot;r&quot;</span>);          </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (file) &#123;                                                                                               </span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"built_in\">fscanf</span>(file, <span class=\"string\">&quot;%s&quot;</span>, flag)!=EOF)</span><br><span class=\"line\">        fclose(file);</span><br><span class=\"line\">    &#125;                                                                                                         </span><br><span class=\"line\">                                                                                                              </span><br><span class=\"line\">    file = fopen( <span class=\"string\">&quot;./permission.txt&quot;</span> , <span class=\"string\">&quot;r&quot;</span>);                                                                  </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (file) &#123;                                                                                               </span><br><span class=\"line\">        <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++)&#123;</span><br><span class=\"line\">            <span class=\"built_in\">fscanf</span>(file, <span class=\"string\">&quot;%s&quot;</span>, permission);                                                                   </span><br><span class=\"line\">        &#125;                                                                                                     </span><br><span class=\"line\">        permission[<span class=\"number\">5</span>] = <span class=\"string\">&#x27;\\0&#x27;</span>;                                                                                 </span><br><span class=\"line\">        fclose(file);                                                                                         </span><br><span class=\"line\">    &#125;                                                                                                         </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!<span class=\"built_in\">strncmp</span>(permission, yes, yes_len)) &#123;                                                                 </span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You have the write permissions.\\n%s\\n&quot;</span>, flag);                                                </span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;                                                                                                  </span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You do not have sufficient permissions to view the flag.\\n&quot;</span>);                                 </span><br><span class=\"line\">    &#125;                                                                                                         </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;                                                                                                 </span><br><span class=\"line\">&#125;              </span><br></pre></td></tr></table></figure>\n<p>程序会判断当前目录下时候有一个名为<code>permission.txt</code>的文件，且文件内容为<code>yes</code>，如果满足，则输出flag。</p>\n<p>由于flag文件打开的位置是绝对的，而permission文件的打开位置是相对的，所以只需要到一个自己有写权限的目录下创建一个permission.txt文件，写入<code>yes</code>，然后运行程序就行了。</p>\n<p>而我们在用户主目录下就拥有写权限，所以在用户主目录下写入并运行程序：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:~$ <span class=\"built_in\">echo</span> -n <span class=\"string\">&quot;yes&quot;</span> &gt; permission.txt                                                      </span><br><span class=\"line\">finn@pico-2018-shell-2:~$ /problems/absolutely-relative_0_d4f0f1c47f503378c4bb81981a80a9b6/absolutely-relative</span><br><span class=\"line\"></span><br><span class=\"line\">You have the write permissions.</span><br><span class=\"line\">picoCTF&#123;3v3r1ng_1<span class=\"variable\">$_r3l3t1v3_befc0ce1</span>&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;3v3r1ng_1$_r3l3t1v3_befc0ce1&#125;</code></p>\n<h1 id=\"in-out-error\">in out error<a title=\"#in-out-error\" href=\"#in-out-error\"></a></h1>\n<h2 id=\"question-13\">Question<a title=\"#question-13\" href=\"#question-13\"></a></h2>\n<blockquote>\n<p>Can you utlize stdin, stdout, and stderr to get the flag from this <a href=\"https://2018shell2.picoctf.com/static/d4999df1f1d898c76bbc6f4c70444886/in-out-error\" target=\"_blank\">program</a>? You can also find it in /problems/in-out-error_2_c33e2a987fbd0f75e78481b14bfd15f4 on the shell server</p>\n</blockquote>\n<h3 id=\"hint-12\">Hint<a title=\"#hint-12\" href=\"#hint-12\"></a></h3>\n<blockquote>\n<p>Maybe you can split the stdout and stderr output?</p>\n</blockquote>\n<h2 id=\"solution-13\">Solution<a title=\"#solution-13\" href=\"#solution-13\"></a></h2>\n<p>linux输出重定向，可以参考<a href=\"https://www.cnblogs.com/softidea/p/3965093.html\" target=\"_blank\">Linux标准输入、输出和错误和文件重定向</a>。</p>\n<p>直接执行程序会把<code>Rick Roll'd</code>的歌词和<code>flag</code>混在一起输出，flag在<code>stderr</code>中，把<code>stdout</code>重定向到<code>/dev/null</code>就可以得到flag。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/in-out-error_0_0f875f7714b995dad5946a15be6267a7$ ./in-out-error 1&gt;/dev/null  </span><br><span class=\"line\">Please may I have the flag?                                                                                   </span><br><span class=\"line\">picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoC</span><br><span class=\"line\">TF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1</span><br><span class=\"line\">p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_</span><br><span class=\"line\">1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_</span><br><span class=\"line\">7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng</span><br><span class=\"line\">_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6</span><br><span class=\"line\">fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;</span><br><span class=\"line\">picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoC</span><br><span class=\"line\">TF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1</span><br><span class=\"line\">p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_</span><br><span class=\"line\">1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_</span><br><span class=\"line\">7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng</span><br><span class=\"line\">_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6</span><br><span class=\"line\">fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;</span><br><span class=\"line\">picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoC</span><br><span class=\"line\">TF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1</span><br><span class=\"line\">p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;p1p1ng_1S_4_7h1ng_85f6fd2c&#125;</code></p>\n<h1 id=\"learn-gdb\">learn gdb<a title=\"#learn-gdb\" href=\"#learn-gdb\"></a></h1>\n<h2 id=\"question-14\">Question<a title=\"#question-14\" href=\"#question-14\"></a></h2>\n<blockquote>\n<p>Using a debugging tool will be extremely useful on your missions. Can you run this <a href=\"https://2018shell2.picoctf.com/static/999e37c9737d95c105ea29ae5b3fac1f/run\" target=\"_blank\">program</a> in gdb and find the flag? You can find the file in /problems/learn-gdb_0_716957192e537ac769f0975c74b34194 on the shell server.</p>\n</blockquote>\n<h3 id=\"hint-13\">Hint<a title=\"#hint-13\" href=\"#hint-13\"></a></h3>\n<blockquote>\n<p>Try setting breakpoints in gdb</p>\n<p>Try and find a point in the program after the flag has been read into memory to break on</p>\n<p>Where is the flag being written in memory?</p>\n</blockquote>\n<h2 id=\"solution-14\">Solution<a title=\"#solution-14\" href=\"#solution-14\"></a></h2>\n<p>执行程序会解密flag，但是不会输出。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/learn-gdb_3_f1f262d9d48b9ff39efc3bc092ea9d7b$ ./run                          </span><br><span class=\"line\">Decrypting the Flag into global variable <span class=\"string\">&#x27;flag_buf&#x27;</span>                                                           </span><br><span class=\"line\">.....................................                                                                         </span><br><span class=\"line\">Finished Reading Flag into global variable <span class=\"string\">&#x27;flag_buf&#x27;</span>. Exiting.</span><br></pre></td></tr></table></figure>\n<p>用<code>gdb</code>加载程序，反汇编<code>main</code>函数。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">finn@pico-2018-shell-2:/problems/learn-gdb_3_f1f262d9d48b9ff39efc3bc092ea9d7b$ gdb run</span><br><span class=\"line\">...</span><br><span class=\"line\">(gdb) disassemble main</span><br><span class=\"line\">... </span><br><span class=\"line\">   0x00000000004008f1 &lt;+40&gt;:    callq  0x400650 &lt;setvbuf@plt&gt;                                                 </span><br><span class=\"line\">   0x00000000004008f6 &lt;+45&gt;:    mov    <span class=\"variable\">$0x4009d0</span>,%edi                                                         </span><br><span class=\"line\">   0x00000000004008fb &lt;+50&gt;:    callq  0x400600 &lt;puts@plt&gt;                                                    </span><br><span class=\"line\">   0x0000000000400900 &lt;+55&gt;:    mov    <span class=\"variable\">$0x0</span>,%eax                                                              </span><br><span class=\"line\">   0x0000000000400905 &lt;+60&gt;:    callq  0x400786 &lt;decrypt_flag&gt;                                                </span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>再反汇编<code>decrypt_flag</code>函数，在打印break-line直接下断点。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(gdb) disas decrypt_flag                                                                                      </span><br><span class=\"line\">...                                               </span><br><span class=\"line\">                                           </span><br><span class=\"line\">   0x0000000000400896 &lt;+272&gt;:   mov    0x200b4b(%rip),%rdx        <span class=\"comment\"># 0x6013e8 &lt;flag_buf&gt;                       </span></span><br><span class=\"line\">   0x000000000040089d &lt;+279&gt;:   mov    -0x20(%rbp),%eax                                                       </span><br><span class=\"line\">   0x00000000004008a0 &lt;+282&gt;:   cltq                                                                          </span><br><span class=\"line\">   0x00000000004008a2 &lt;+284&gt;:   add    %rdx,%rax                                                              </span><br><span class=\"line\">   0x00000000004008a5 &lt;+287&gt;:   movb   <span class=\"variable\">$0x0</span>,(%rax)                                                            </span><br><span class=\"line\">   0x00000000004008a8 &lt;+290&gt;:   mov    <span class=\"variable\">$0xa</span>,%edi                                                              </span><br><span class=\"line\">   0x00000000004008ad &lt;+295&gt;:   callq  0x4005f0 &lt;putchar@plt&gt;                                                 </span><br><span class=\"line\">   0x00000000004008b2 &lt;+300&gt;:   nop                                                                           </span><br><span class=\"line\">...</span><br><span class=\"line\">(gdb) b *0x00000000004008a8                                                                                   </span><br><span class=\"line\">Breakpoint 1 at 0x4008a8                                                                                      </span><br><span class=\"line\">(gdb) r                                                                                                       </span><br><span class=\"line\">Starting program: /problems/learn-gdb_3_f1f262d9d48b9ff39efc3bc092ea9d7b/run                                  </span><br><span class=\"line\">Decrypting the Flag into global variable <span class=\"string\">&#x27;flag_buf&#x27;</span>                                                           </span><br><span class=\"line\">.....................................                                                                         </span><br><span class=\"line\">Breakpoint 1, 0x00000000004008a8 <span class=\"keyword\">in</span> decrypt_flag ()   </span><br></pre></td></tr></table></figure>\n<p><code>printf &quot;%s&quot;, (char *) flag_buf</code>打印<code>flag_buf</code>变量，得到flag。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(gdb) <span class=\"built_in\">printf</span> <span class=\"string\">&quot;%s&quot;</span>, (char *) flag_buf                                                                          </span><br><span class=\"line\">picoCTF&#123;gDb_iS_sUp3r_u53fuL_efaa2b29&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;gDb_iS_sUp3r_u53fuL_efaa2b29&#125;</code></p>\n<h1 id=\"roulette\">roulette<a title=\"#roulette\" href=\"#roulette\"></a></h1>\n<h2 id=\"question-15\">Question<a title=\"#question-15\" href=\"#question-15\"></a></h2>\n<blockquote>\n<p>This Online <a href=\"https://2018shell2.picoctf.com/static/2d8417ef7707fec56592db02da54575e/roulette\" target=\"_blank\">Roulette</a> Service is in Beta. Can you find a way to win $1,000,000,000 and get the flag? <a href=\"https://2018shell2.picoctf.com/static/2d8417ef7707fec56592db02da54575e/roulette.c\" target=\"_blank\">Source</a>. Connect with <code>nc 2018shell1.picoctf.com 5731</code></p>\n</blockquote>\n<h3 id=\"hint-14\">Hint<a title=\"#hint-14\" href=\"#hint-14\"></a></h3>\n<blockquote>\n<p>There are 2 bugs!</p>\n</blockquote>\n<h2 id=\"solution-15\">Solution<a title=\"#solution-15\" href=\"#solution-15\"></a></h2>\n<p>查看源码，发现出问题的地方有两个。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">long</span> <span class=\"title\">get_rand</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">long</span> seed;</span><br><span class=\"line\">  FILE *f = fopen(<span class=\"string\">&quot;/dev/urandom&quot;</span>, <span class=\"string\">&quot;r&quot;</span>);</span><br><span class=\"line\">  fread(&amp;seed, <span class=\"keyword\">sizeof</span>(seed), <span class=\"number\">1</span>, f);</span><br><span class=\"line\">  fclose(f);</span><br><span class=\"line\">  seed = seed % <span class=\"number\">5000</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (seed &lt; <span class=\"number\">0</span>) seed = seed * <span class=\"number\">-1</span>;</span><br><span class=\"line\">  srand(seed);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> seed;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span> </span>&#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  cash = get_rand();</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这里直接用随机数种子作为初始cash值，所以可以用cash来预测后面的随机数。</p>\n<p>第二个问题出现在<code>get_long()</code>函数。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">long</span> <span class=\"title\">get_long</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;&gt; &quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">uint64_t</span> l = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">char</span> c = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(!is_digit(c))</span><br><span class=\"line\">      c = getchar();</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(is_digit(c)) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(l &gt;= LONG_MAX) &#123;</span><br><span class=\"line\">        l = LONG_MAX;</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      l *= <span class=\"number\">10</span>;</span><br><span class=\"line\">      l += c - <span class=\"string\">&#x27;0&#x27;</span>;</span><br><span class=\"line\">      c = getchar();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c != <span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\">      c = getchar();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> l;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这个函数会返回一个有符号长整型的值，但是，在中间的运算过程却使用了一个无符号的<code>uint64_t</code>。</p>\n<p>所以当我们构造一个特别大的输入时，就可以造成溢出，使函数返回一个有符号的负数。</p>\n<p>基于以上两个bug，我们就可以构造出满足以下要求的输入了。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(cash &gt; ONE_BILLION) &#123; <span class=\"comment\">// cash大于十亿</span></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;*** Current Balance: $%lu ***\\n&quot;</span>, cash);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (wins &gt;= HOTSTREAK) &#123;<span class=\"comment\">// 连胜次数大于等于三次</span></span><br><span class=\"line\">\t  <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Wow, I can&#x27;t believe you did it.. You deserve this flag!&quot;</span>);</span><br><span class=\"line\">\t  print_flag();</span><br><span class=\"line\">\t  <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>预测随机数用的c程序</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span> </span>&#123;</span><br><span class=\"line\">\tsrand(atoi(argv[<span class=\"number\">1</span>]));</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">8</span>; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">long</span> k = (rand() % <span class=\"number\">36</span>) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (i % <span class=\"number\">2</span> == <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%ld &quot;</span>, k);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>产生随机数序列</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~ gcc generator.c -o random_predict</span><br><span class=\"line\">~ ./random_predict 611</span><br><span class=\"line\">12 23 34 26</span><br><span class=\"line\">~</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ nc 2018shell2.picoctf.com 48312</span><br><span class=\"line\">Welcome to ONLINE ROULETTE!</span><br><span class=\"line\">Here, have <span class=\"variable\">$611</span> to start on the house! You<span class=\"string\">&#x27;ll lose it all anyways &gt;:)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">How much will you wager?</span></span><br><span class=\"line\"><span class=\"string\">Current Balance: $611 \t Current Wins: 0</span></span><br><span class=\"line\"><span class=\"string\">&gt; 611</span></span><br><span class=\"line\"><span class=\"string\">Choose a number (1-36)</span></span><br><span class=\"line\"><span class=\"string\">&gt; 12</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Spinning the Roulette for a chance to win $1222!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Roulette  :  12</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">You chose correct!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">How much will you wager?</span></span><br><span class=\"line\"><span class=\"string\">Current Balance: $1222 \t Current Wins: 1</span></span><br><span class=\"line\"><span class=\"string\">&gt; 1222</span></span><br><span class=\"line\"><span class=\"string\">Choose a number (1-36)</span></span><br><span class=\"line\"><span class=\"string\">&gt; 23</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Spinning the Roulette for a chance to win $2444!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Roulette  :  23</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Wow, you won!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">How much will you wager?</span></span><br><span class=\"line\"><span class=\"string\">Current Balance: $2444 \t Current Wins: 2</span></span><br><span class=\"line\"><span class=\"string\">&gt; 2444</span></span><br><span class=\"line\"><span class=\"string\">Choose a number (1-36)</span></span><br><span class=\"line\"><span class=\"string\">&gt; 34</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Spinning the Roulette for a chance to win $4888!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Roulette  :  34</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Congrats!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">How much will you wager?</span></span><br><span class=\"line\"><span class=\"string\">Current Balance: $4888 \t Current Wins: 3</span></span><br><span class=\"line\"><span class=\"string\">&gt; 3221225472</span></span><br><span class=\"line\"><span class=\"string\">Choose a number (1-36)</span></span><br><span class=\"line\"><span class=\"string\">&gt; 25</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Spinning the Roulette for a chance to win $2147483648!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Roulette  :  26</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">WRONG</span></span><br><span class=\"line\"><span class=\"string\">If you keep it up, maybe you&#x27;</span>ll get the flag <span class=\"keyword\">in</span> 100000000000 years</span><br><span class=\"line\"></span><br><span class=\"line\">*** Current Balance: <span class=\"variable\">$1073746712</span> ***</span><br><span class=\"line\">Wow, I can<span class=\"string\">&#x27;t believe you did it.. You deserve this flag!</span></span><br><span class=\"line\"><span class=\"string\">picoCTF&#123;1_h0p3_y0u_f0uNd_b0tH_bUg5_8fb4d984&#125;</span></span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;1_h0p3_y0u_f0uNd_b0tH_bUg5_8fb4d984&#125;</code></p>\n<h1 id=\"store\">store<a title=\"#store\" href=\"#store\"></a></h1>\n<h2 id=\"question-16\">Question<a title=\"#question-16\" href=\"#question-16\"></a></h2>\n<blockquote>\n<p>We started a little <a href=\"https://2018shell2.picoctf.com/static/52a992a4afd3bd8ad54489efbec0fd5c/store\" target=\"_blank\">store</a>, can you buy the flag? <a href=\"https://2018shell2.picoctf.com/static/52a992a4afd3bd8ad54489efbec0fd5c/source.c\" target=\"_blank\">Source</a>. Connect with <code>2018shell1.picoctf.com 53220</code>.</p>\n</blockquote>\n<h3 id=\"hint-15\">Hint<a title=\"#hint-15\" href=\"#hint-15\"></a></h3>\n<blockquote>\n<p>Two’s compliment can do some weird things when numbers get really big!</p>\n</blockquote>\n<h2 id=\"solution-16\">Solution<a title=\"#solution-16\" href=\"#solution-16\"></a></h2>\n<p>也是一个整数溢出的问题，购买一个小额的商品，造成负数溢出就可以使自己的钱数增加。</p>\n<p>但是……出题人好像忘记去掉一些东西，直接把flag放在了二进制可执行文件里，所以直接<code>strings</code>就能得到flag了=-=。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~ strings store |grep pico</span><br><span class=\"line\">YOUR FLAG IS: picoCTF&#123;numb3r3_4r3nt_s4f3_dbd42a50&#125;</span><br></pre></td></tr></table></figure>\n<p>常规解法如下。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Welcome to the Store App V1.0</span><br><span class=\"line\">World<span class=\"string\">&#x27;s Most Secure Purchasing App</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[1] Check Account Balance</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[2] Buy Stuff</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[3] Exit</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"> Enter a menu selection</span></span><br><span class=\"line\"><span class=\"string\">2</span></span><br><span class=\"line\"><span class=\"string\">Current Auctions</span></span><br><span class=\"line\"><span class=\"string\">[1] I Can&#x27;</span>t Believe its not a Flag!</span><br><span class=\"line\">[2] Real Flag</span><br><span class=\"line\">1</span><br><span class=\"line\">Imitation Flags cost 1000 each, how many would you like?</span><br><span class=\"line\">10000000000000000</span><br><span class=\"line\"></span><br><span class=\"line\">Your total cost is: -1981284352</span><br><span class=\"line\"></span><br><span class=\"line\">Your new balance: 1981285452</span><br><span class=\"line\"></span><br><span class=\"line\">Welcome to the Store App V1.0</span><br><span class=\"line\">World<span class=\"string\">&#x27;s Most Secure Purchasing App</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[1] Check Account Balance</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[2] Buy Stuff</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[3] Exit</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"> Enter a menu selection</span></span><br><span class=\"line\"><span class=\"string\">2</span></span><br><span class=\"line\"><span class=\"string\">Current Auctions</span></span><br><span class=\"line\"><span class=\"string\">[1] I Can&#x27;</span>t Believe its not a Flag!</span><br><span class=\"line\">[2] Real Flag</span><br><span class=\"line\">2</span><br><span class=\"line\">A genuine Flag costs 100000 dollars, and we only have 1 <span class=\"keyword\">in</span> stock</span><br><span class=\"line\">Enter 1 to purchase1</span><br><span class=\"line\">YOUR FLAG IS: picoCTF&#123;numb3r3_4r3nt_s4f3_dbd42a50&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;numb3r3_4r3nt_s4f3_dbd42a50&#125;</code></p>\n","prev":{"title":"picoCTF2018 Writeup之Cryptography篇","link":"undefined/picoCTF2018-Writeup之Cryptography篇"},"next":{"title":"picoCTF2018 Writeup之Web Exploitation篇","link":"undefined/picoCTF2018-Writeup之Web-Exploitation篇"},"plink":"https://pineswen.tk/undefined/picoCTF2018-Writeup之General-skills篇/","toc":[{"id":"前言","title":"前言","index":"1"},{"id":"general-warmup-1-2-3","title":"General Warmup 1 2 3","index":"2","children":[{"id":"question","title":"Question","index":"2.1"}]},{"id":"solution","title":"Solution","index":"3"},{"id":"resources","title":"Resources","index":"4","children":[{"id":"question-1","title":"Question","index":"4.1","children":[{"id":"hint","title":"Hint","index":"4.1.1"}]},{"id":"solution-1","title":"Solution","index":"4.2"}]},{"id":"grep-1","title":"Grep 1","index":"5","children":[{"id":"question-2","title":"Question","index":"5.1","children":[{"id":"hint-1","title":"Hint","index":"5.1.1"}]},{"id":"solution-2","title":"Solution","index":"5.2"}]},{"id":"net-cat","title":"net cat","index":"6","children":[{"id":"question-3","title":"Question","index":"6.1","children":[{"id":"hint-2","title":"Hint","index":"6.1.1"}]},{"id":"solution-3","title":"Solution","index":"6.2"}]},{"id":"pipe","title":"pipe","index":"7","children":[{"id":"question-4","title":"Question","index":"7.1","children":[{"id":"hint-3","title":"Hint","index":"7.1.1"}]},{"id":"solution-4","title":"Solution","index":"7.2"}]},{"id":"strings","title":"Strings","index":"8","children":[{"id":"question-5","title":"Question","index":"8.1","children":[{"id":"hint-4","title":"Hint","index":"8.1.1"}]},{"id":"solution-5","title":"Solution","index":"8.2"}]},{"id":"grep-2","title":"grep 2","index":"9","children":[{"id":"question-6","title":"Question","index":"9.1","children":[{"id":"hint-5","title":"Hint","index":"9.1.1"}]},{"id":"solution-6","title":"Solution","index":"9.2"}]},{"id":"aca-shell-a","title":"Aca-Shell-A","index":"10","children":[{"id":"question-7","title":"Question","index":"10.1","children":[{"id":"hint-6","title":"Hint","index":"10.1.1"}]},{"id":"solution-7","title":"Solution","index":"10.2"}]},{"id":"environ","title":"environ","index":"11","children":[{"id":"question-8","title":"Question","index":"11.1","children":[{"id":"hint-7","title":"Hint","index":"11.1.1"}]},{"id":"solution-8","title":"Solution","index":"11.2"}]},{"id":"ssh-keyz","title":"ssh-keyz","index":"12","children":[{"id":"question-9","title":"Question","index":"12.1","children":[{"id":"hint-8","title":"Hint","index":"12.1.1"}]},{"id":"solution-9","title":"Solution","index":"12.2"}]},{"id":"what-base-is-this?","title":"what base is this?","index":"13","children":[{"id":"question-10","title":"Question","index":"13.1","children":[{"id":"hint-9","title":"Hint","index":"13.1.1"}]},{"id":"solution-10","title":"Solution","index":"13.2"}]},{"id":"you-can't-see-me","title":"you can’t see me","index":"14","children":[{"id":"question-11","title":"Question","index":"14.1","children":[{"id":"hint-10","title":"Hint","index":"14.1.1"}]},{"id":"solution-11","title":"Solution","index":"14.2"}]},{"id":"absolutely-relative","title":"absolutely relative","index":"15","children":[{"id":"question-12","title":"Question","index":"15.1","children":[{"id":"hint-11","title":"Hint","index":"15.1.1"}]},{"id":"solution-12","title":"Solution","index":"15.2"}]},{"id":"in-out-error","title":"in out error","index":"16","children":[{"id":"question-13","title":"Question","index":"16.1","children":[{"id":"hint-12","title":"Hint","index":"16.1.1"}]},{"id":"solution-13","title":"Solution","index":"16.2"}]},{"id":"learn-gdb","title":"learn gdb","index":"17","children":[{"id":"question-14","title":"Question","index":"17.1","children":[{"id":"hint-13","title":"Hint","index":"17.1.1"}]},{"id":"solution-14","title":"Solution","index":"17.2"}]},{"id":"roulette","title":"roulette","index":"18","children":[{"id":"question-15","title":"Question","index":"18.1","children":[{"id":"hint-14","title":"Hint","index":"18.1.1"}]},{"id":"solution-15","title":"Solution","index":"18.2"}]},{"id":"store","title":"store","index":"19","children":[{"id":"question-16","title":"Question","index":"19.1","children":[{"id":"hint-15","title":"Hint","index":"19.1.1"}]},{"id":"solution-16","title":"Solution","index":"19.2"}]}]}