{"title":"picoCTF2018 Writeup之Forensics篇","date":"2018-11-01T22:08:26.000Z","date_formatted":{"ll":"Nov 1, 2018","L":"11/01/2018","MM-DD":"11-01"},"link":"/picoCTF2018-Writeup之Forensics篇","tags":["CTF"],"updated":"2020-12-27T16:45:50.786Z","content":"<p>旧文搬运，原文地址:<a href=\"https://xz.aliyun.com/t/3098\">https://xz.aliyun.com/t/3098</a></p>\n<h1 id=\"前言\">前言<a title=\"#前言\" href=\"#前言\"></a></h1>\n<p>本篇是Forensic，即取证类的题解。包括有一些常规的入门misc题目，比如流量分析，图片、文件隐写之类的。部分题目附件已打包。链接: <a href=\"https://pan.baidu.com/s/1kfx8GEnio7V1Z5Fa4TrfMQ\">https://pan.baidu.com/s/1kfx8GEnio7V1Z5Fa4TrfMQ</a> 提取码: 5a9u</p>\n<p>（拖了半个月终于把这篇补完了，还好题目还开着，拖延症彻底没救了-0-……）</p>\n<a id=\"more\"></a>\n<h1 id=\"forensics-warmup-1\">Forensics Warmup 1<a title=\"#forensics-warmup-1\" href=\"#forensics-warmup-1\"></a></h1>\n<h2 id=\"question\">Question<a title=\"#question\" href=\"#question\"></a></h2>\n<blockquote>\n<p>Can you unzip this <a href=\"https://2018shell2.picoctf.com/static/d6487f8e2cbbb28b5168b512f0ac0710/flag.zip\" target=\"_blank\">file</a> for me and retreive the flag?</p>\n</blockquote>\n<h3 id=\"hint\">Hint<a title=\"#hint\" href=\"#hint\"></a></h3>\n<blockquote>\n<p>Make sure to submit the flag as picoCTF{XXXXX}</p>\n</blockquote>\n<h2 id=\"solution\">Solution<a title=\"#solution\" href=\"#solution\"></a></h2>\n<p>签到题，解压zip，得到<code>flag.jpg</code></p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181027180125.png\" alt=\"\" class=\"φcx\"></p>\n<p>输入图上的字符就行了。</p>\n<p>flag:<code>picoCTF&#123;welcone_to_forensics&#125;</code></p>\n<h1 id=\"forensics-warmup-2\">Forensics Warmup 2<a title=\"#forensics-warmup-2\" href=\"#forensics-warmup-2\"></a></h1>\n<h2 id=\"question-1\">Question<a title=\"#question-1\" href=\"#question-1\"></a></h2>\n<blockquote>\n<p>Hmm for some reason I can’t open this <a href=\"https://2018shell2.picoctf.com/static/b96c236db4c32ed47e9958c7e461b3c4/flag.png\" target=\"_blank\">PNG</a>? Any ideas?</p>\n</blockquote>\n<h3 id=\"hint-1\">Hint<a title=\"#hint-1\" href=\"#hint-1\"></a></h3>\n<blockquote>\n<p>How do operating systems know what kind of file it is? (It’s not just the ending!</p>\n<p>Make sure to submit the flag as picoCTF{XXXXX}</p>\n</blockquote>\n<h2 id=\"solution-1\">Solution<a title=\"#solution-1\" href=\"#solution-1\"></a></h2>\n<p>使用<code>file</code>命令查看图片的文件格式。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">❯ file flag.png</span><br><span class=\"line\">flag.png: JPEG image data, JFIF standard 1.01, resolution (DPI), density 75x75, segment length 16, baseline, precision 8, 909x190, frames 3</span><br></pre></td></tr></table></figure>\n<p>本质是jpg文件，修改后缀为.jpg就可以打开了。（其实大多的图片浏览器都可以直接打开这种单纯修改一下后缀的图片）</p>\n<p>flag:<code>picoCTF&#123;extensions_are_a_lie&#125;</code></p>\n<h1 id=\"desrouleaux\">Desrouleaux<a title=\"#desrouleaux\" href=\"#desrouleaux\"></a></h1>\n<h2 id=\"question-2\">Question<a title=\"#question-2\" href=\"#question-2\"></a></h2>\n<blockquote>\n<p>Our network administrator is having some trouble handling the tickets for all of of our incidents. Can you help him out by answering all the questions? Connect with <code>nc 2018shell1.picoctf.com 54782</code>. <a href=\"https://2018shell2.picoctf.com/static/47cbb94e79b74a4b2f74cfb31c68230e/incidents.json\" target=\"_blank\">incidents.json</a></p>\n</blockquote>\n<h3 id=\"hint-2\">Hint<a title=\"#hint-2\" href=\"#hint-2\"></a></h3>\n<blockquote>\n<p>If you need to code, python has some good libraries for it.</p>\n</blockquote>\n<h2 id=\"solution-2\">Solution<a title=\"#solution-2\" href=\"#solution-2\"></a></h2>\n<p>文件里面是一段json数据。</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">            <span class=\"attr\">&quot;ticket_id&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;timestamp&quot;</span>: <span class=\"string\">&quot;2015/05/09 22:28:20&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;file_hash&quot;</span>: <span class=\"string\">&quot;b807c12fc3e10ba3&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;src_ip&quot;</span>: <span class=\"string\">&quot;248.63.150.241&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;dst_ip&quot;</span>: <span class=\"string\">&quot;251.0.92.254&quot;</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"attr\">&quot;ticket_id&quot;</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;timestamp&quot;</span>: <span class=\"string\">&quot;2016/12/27 04:01:52&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;file_hash&quot;</span>: <span class=\"string\">&quot;1698b8b87f51ce8e&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;src_ip&quot;</span>: <span class=\"string\">&quot;248.63.150.241&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;dst_ip&quot;</span>: <span class=\"string\">&quot;116.196.246.151&quot;</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>nc到问题服务器，一步步处理后发现有三个问题：</p>\n<ol>\n<li>What is the most common source IP address?</li>\n<li>How many unique destination IP addresses were targeted by the source IP address 236.232.221.165?</li>\n<li>What is the average number of unique destination IP addresses that were sent a file with the same hash? Your answer needs to be correct to 2 decimal places.</li>\n</ol>\n<p>第三个有点拗口，大概意思就是要算出每个单独的文件发送到的ip地址个数的平均数是多少。使用python的list和dict对象可以很方便的处理这些数据。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;./incidents.json&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    text = f.read()</span><br><span class=\"line\">text = json.loads(text)</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">&#x27;2018shell2.picoctf.com&#x27;</span>, <span class=\"number\">54782</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">src_ip_count = &#123;&#125;</span><br><span class=\"line\">dst_ip_count = []</span><br><span class=\"line\">unique_dst_ip = <span class=\"number\">0</span></span><br><span class=\"line\">hash_dst_ip = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">r.recvuntil(<span class=\"string\">&#x27;common ones.&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> text[<span class=\"string\">&#x27;tickets&#x27;</span>]:</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Question 1</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> i[<span class=\"string\">&#x27;src_ip&#x27;</span>] <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> src_ip_count.keys():</span><br><span class=\"line\">        src_ip_count[i[<span class=\"string\">&#x27;src_ip&#x27;</span>]] = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        src_ip_count[i[<span class=\"string\">&#x27;src_ip&#x27;</span>]] += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">r.sendline(<span class=\"built_in\">max</span>(src_ip_count))</span><br><span class=\"line\">content = r.recvuntil(<span class=\"string\">&#x27;?\\n&#x27;</span>)</span><br><span class=\"line\">content = re.findall(<span class=\"string\">r&#x27;address \\d&#123;1,3&#125;.\\d&#123;1,3&#125;.\\d&#123;1,3&#125;.\\d&#123;1,3&#125; ?&#x27;</span>,content)</span><br><span class=\"line\">content = <span class=\"string\">&#x27;&#x27;</span>.join(content).split(<span class=\"string\">&#x27; &#x27;</span>)[<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> text[<span class=\"string\">&#x27;tickets&#x27;</span>]:</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Question 2</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> i[<span class=\"string\">&#x27;dst_ip&#x27;</span>] <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> dst_ip_count <span class=\"keyword\">and</span> i[<span class=\"string\">&#x27;src_ip&#x27;</span>] == content:</span><br><span class=\"line\">        dst_ip_count.append(i[<span class=\"string\">&#x27;dst_ip&#x27;</span>])</span><br><span class=\"line\">        unique_dst_ip += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Question 3</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> i[<span class=\"string\">&#x27;file_hash&#x27;</span>] <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> hash_dst_ip.keys() <span class=\"keyword\">and</span> i[<span class=\"string\">&#x27;file_hash&#x27;</span>] != []:</span><br><span class=\"line\">        hash_dst_ip[i[<span class=\"string\">&#x27;file_hash&#x27;</span>]] = []</span><br><span class=\"line\">        hash_dst_ip[i[<span class=\"string\">&#x27;file_hash&#x27;</span>]].append(i[<span class=\"string\">&#x27;dst_ip&#x27;</span>])</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> i[<span class=\"string\">&#x27;file_hash&#x27;</span>] <span class=\"keyword\">in</span> hash_dst_ip.keys() <span class=\"keyword\">and</span> i[<span class=\"string\">&#x27;file_hash&#x27;</span>] != []:</span><br><span class=\"line\">        hash_dst_ip[i[<span class=\"string\">&#x27;file_hash&#x27;</span>]].append(i[<span class=\"string\">&#x27;dst_ip&#x27;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">avg = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> hash_dst_ip:</span><br><span class=\"line\">    avg += <span class=\"built_in\">len</span>(hash_dst_ip[i])</span><br><span class=\"line\">avg = avg * <span class=\"number\">1.0</span> / <span class=\"built_in\">len</span>(hash_dst_ip)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># print unique_dst_ip</span></span><br><span class=\"line\"><span class=\"comment\"># print round(avg, 2)</span></span><br><span class=\"line\"></span><br><span class=\"line\">r.sendline(<span class=\"built_in\">str</span>(unique_dst_ip))</span><br><span class=\"line\">r.sendline(<span class=\"built_in\">str</span>(<span class=\"built_in\">round</span>(avg, <span class=\"number\">2</span>)))</span><br><span class=\"line\"><span class=\"comment\"># r.interactive()</span></span><br><span class=\"line\"><span class=\"built_in\">print</span> r.recvuntil(<span class=\"string\">&#x27;&#125;\\n&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">r.close()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>运行脚本得到flag。</p>\n<p>flag:<code>picoCTF&#123;J4y_s0n_d3rUUUULo_c74e3495&#125;</code></p>\n<h1 id=\"reading-between-the-eyes\">Reading Between the Eyes<a title=\"#reading-between-the-eyes\" href=\"#reading-between-the-eyes\"></a></h1>\n<h2 id=\"question-3\">Question<a title=\"#question-3\" href=\"#question-3\"></a></h2>\n<blockquote>\n<p>Stego-Saurus hid a message for you in this <a href=\"https://2018shell2.picoctf.com/static/3e423171eed198e8425524a1b052869b/husky.png\" target=\"_blank\">image</a>, can you retreive it?</p>\n</blockquote>\n<h3 id=\"hint-3\">Hint<a title=\"#hint-3\" href=\"#hint-3\"></a></h3>\n<blockquote>\n<p>Maybe you can find an online decoder?</p>\n</blockquote>\n<h2 id=\"solution-3\">Solution<a title=\"#solution-3\" href=\"#solution-3\"></a></h2>\n<p>LSB隐写，使用<code>stegsolve</code>提取最低位。</p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028003956.png\" alt=\"\" class=\"φcx\"></p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028004030.png\" alt=\"\" class=\"φcx\"></p>\n<p>勾选RGB信道的最低位<code>0</code>，顺序是LSB First，就可以看到flag。</p>\n<p>flag:<code>picoCTF&#123;r34d1ng_b37w33n_7h3_by73s&#125;</code></p>\n<h1 id=\"recovering-from-the-snap\">Recovering From the Snap<a title=\"#recovering-from-the-snap\" href=\"#recovering-from-the-snap\"></a></h1>\n<h2 id=\"question-4\">Question<a title=\"#question-4\" href=\"#question-4\"></a></h2>\n<blockquote>\n<p>There used to be a bunch of <a href=\"https://2018shell2.picoctf.com/static/1603334c6d1519a49283974d0d480ffe/animals.dd\" target=\"_blank\">animals</a> here, what did Dr. Xernon do to them?</p>\n</blockquote>\n<h3 id=\"hint-4\">Hint<a title=\"#hint-4\" href=\"#hint-4\"></a></h3>\n<blockquote>\n<p>Some files have been deleted from the disk image, but are they really gone?.</p>\n</blockquote>\n<h2 id=\"solution-4\">Solution<a title=\"#solution-4\" href=\"#solution-4\"></a></h2>\n<p>使用<code>binwalk</code>查看文件，发现有很多隐写进去的jpg文件，用<code>foremost</code>提取出来。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">❯ foremost animals.dd</span><br><span class=\"line\">foremost: /usr/<span class=\"built_in\">local</span>/etc/foremost.conf: No such file or directory</span><br><span class=\"line\">Processing: animals.dd</span><br><span class=\"line\">|*|</span><br></pre></td></tr></table></figure>\n<p>提取完成查看图片，可以看到最后一张就是flag。</p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028005038.png\" alt=\"\" class=\"φcx\"></p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028005137.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;th3_5n4p_happ3n3d&#125;</code></p>\n<h1 id=\"admin-panel\">admin panel<a title=\"#admin-panel\" href=\"#admin-panel\"></a></h1>\n<h2 id=\"question-5\">Question<a title=\"#question-5\" href=\"#question-5\"></a></h2>\n<blockquote>\n<p>We captured some <a href=\"https://2018shell2.picoctf.com/static/ee6ed2afe1da153ae06e61d5ee26d52d/data.pcap\" target=\"_blank\">traffic</a> logging into the admin panel, can you find the password?</p>\n</blockquote>\n<h3 id=\"hint-5\">Hint<a title=\"#hint-5\" href=\"#hint-5\"></a></h3>\n<blockquote>\n<p>Tools like wireshark are pretty good for analyzing pcap files.</p>\n</blockquote>\n<h2 id=\"solution-5\">Solution<a title=\"#solution-5\" href=\"#solution-5\"></a></h2>\n<p>使用wireshrak打开pcap流量包，追踪tcp流，在第5个流可以看到flag。</p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028005557.png\" alt=\"\" class=\"φcx\"></p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028005621.png\" alt=\"\" class=\"φcx\"></p>\n<p>当然这里我们知道flag的形式是<code>picoCTF&#123;***&#125;</code>，可以直接在分组字节流中搜索相关字符串，同样也可以找到flag。</p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/image-20181028005815964.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;n0ts3cur3_13597b43&#125;</code></p>\n<h1 id=\"hex-editor\">hex editor<a title=\"#hex-editor\" href=\"#hex-editor\"></a></h1>\n<h2 id=\"question-6\">Question<a title=\"#question-6\" href=\"#question-6\"></a></h2>\n<blockquote>\n<p>This <a href=\"https://2018shell2.picoctf.com/static/ccad03a151a0edac8bd01e665a595b7a/hex_editor.jpg\" target=\"_blank\">cat</a> has a secret to teach you. You can also find the file in /problems/hex-editor_2_c1a99aee8d919f6e42697662d798f0ff on the shell server.</p>\n</blockquote>\n<h3 id=\"hint-6\">Hint<a title=\"#hint-6\" href=\"#hint-6\"></a></h3>\n<blockquote>\n<p>What is a hex editor?</p>\n<p>Maybe google knows.</p>\n<p><a href=\"http://linuxcommand.org/man_pages/xxd1.html\" target=\"_blank\">xxd</a></p>\n<p><a href=\"http://linuxcommand.org/man_pages/hexedit1.html\" target=\"_blank\">hexedit</a></p>\n<p><a href=\"http://manpages.ubuntu.com/manpages/natty/man1/bvi.1.html\" target=\"_blank\">bvi</a></p>\n</blockquote>\n<h2 id=\"solution-6\">Solution<a title=\"#solution-6\" href=\"#solution-6\"></a></h2>\n<p>使用16进制编辑器查看文件16进制内容，windows环境下可以使用winhex、010editor，mac环境下可以使用hex friend。</p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028010308.png\" alt=\"\" class=\"φcx\"></p>\n<p>可以看到到jpg文件格式的结尾<code>FF D9</code>之后还有一串字符，就是我们要的flag。</p>\n<p>flag:<code>picoCTF&#123;and_thats_how_u_edit_hex_kittos_8BcA67a2&#125;</code></p>\n<h1 id=\"truly-an-artist\">Truly an Artist<a title=\"#truly-an-artist\" href=\"#truly-an-artist\"></a></h1>\n<h2 id=\"question-7\">Question<a title=\"#question-7\" href=\"#question-7\"></a></h2>\n<blockquote>\n<p>Can you help us find the flag in this <a href=\"https://2018shell2.picoctf.com/static/a386ed9a7534702173762cf536dce121/2018.png\" target=\"_blank\">Meta-Material</a>? You can also find the file in /problems/truly-an-artist_3_066d6319e350c1d579e5cf32e326ba02.</p>\n</blockquote>\n<h3 id=\"hint-7\">Hint<a title=\"#hint-7\" href=\"#hint-7\"></a></h3>\n<blockquote>\n<p>Try looking beyond the image.</p>\n<p>Who created this?</p>\n</blockquote>\n<h2 id=\"solution-7\">Solution<a title=\"#solution-7\" href=\"#solution-7\"></a></h2>\n<p>文件属性隐藏了信息，windows下直接右键查看文件属性就可以看到，mac可以使用exiftool查看。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">❯ exiftool 2018.png</span><br><span class=\"line\">ExifTool Version Number         : 11.11</span><br><span class=\"line\">File Name                       : 2018.png</span><br><span class=\"line\">Directory                       : .</span><br><span class=\"line\">File Size                       : 13 kB</span><br><span class=\"line\">File Modification Date/Time     : 2018:10:28 01:06:38+08:00</span><br><span class=\"line\">File Access Date/Time           : 2018:10:28 01:06:50+08:00</span><br><span class=\"line\">File Inode Change Date/Time     : 2018:10:28 01:06:51+08:00</span><br><span class=\"line\">File Permissions                : rw-r--r--</span><br><span class=\"line\">File Type                       : PNG</span><br><span class=\"line\">File Type Extension             : png</span><br><span class=\"line\">MIME Type                       : image/png</span><br><span class=\"line\">Image Width                     : 1200</span><br><span class=\"line\">Image Height                    : 630</span><br><span class=\"line\">Bit Depth                       : 8</span><br><span class=\"line\">Color Type                      : RGB</span><br><span class=\"line\">Compression                     : Deflate/Inflate</span><br><span class=\"line\">Filter                          : Adaptive</span><br><span class=\"line\">Interlace                       : Noninterlaced</span><br><span class=\"line\">Artist                          : picoCTF&#123;look_in_image_7e31505f&#125;</span><br><span class=\"line\">Image Size                      : 1200x630</span><br><span class=\"line\">Megapixels                      : 0.756</span><br></pre></td></tr></table></figure>\n<p>flag:<code>picoCTF&#123;look_in_image_7e31505f&#125;</code></p>\n<h1 id=\"now-you-don't\">now you don’t<a title=\"#now-you-don't\" href=\"#now-you-don't\"></a></h1>\n<h2 id=\"question-8\">Question<a title=\"#question-8\" href=\"#question-8\"></a></h2>\n<blockquote>\n<p>We heard that there is something hidden in this <a href=\"https://2018shell2.picoctf.com/static/e7afc1873bc40e4d15f532b4859623e7/nowYouDont.png\" target=\"_blank\">picture</a>. Can you find it?</p>\n</blockquote>\n<h3 id=\"hint-8\">Hint<a title=\"#hint-8\" href=\"#hint-8\"></a></h3>\n<blockquote>\n<p>There is an old saying: if you want to hide the treasure, put it in plain sight. Then no one will see it.</p>\n<p>Is it really all one shade of red?</p>\n</blockquote>\n<h2 id=\"solution-8\">Solution<a title=\"#solution-8\" href=\"#solution-8\"></a></h2>\n<p>还是用<code>stegsolve</code>打开文件，查看不同信道下的图片，发现flag在隐藏在红色0信道中。</p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028011216.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;n0w_y0u533_m3&#125;</code></p>\n<h1 id=\"ext-super-magic\">Ext Super Magic<a title=\"#ext-super-magic\" href=\"#ext-super-magic\"></a></h1>\n<h2 id=\"question-9\">Question<a title=\"#question-9\" href=\"#question-9\"></a></h2>\n<blockquote>\n<p>We salvaged a ruined Ext SuperMagic II-class mech recently and pulled the <a href=\"https://2018shell2.picoctf.com/static/bef2a485087cc9842099ac9bd3e0041f/ext-super-magic.img\" target=\"_blank\">filesystem</a> out of the black box. It looks a bit corrupted, but maybe there’s something interesting in there. You can also find it in /problems/ext-super-magic_4_f196e59a80c3fdac37cc2f331692ef13 on the shell server.</p>\n</blockquote>\n<h3 id=\"hint-9\">Hint<a title=\"#hint-9\" href=\"#hint-9\"></a></h3>\n<blockquote>\n<p>Are there any <a href=\"https://en.wikipedia.org/wiki/Fsck\" target=\"_blank\">tools</a> for diagnosing corrupted filesystems? What do they say if you run them on this one?</p>\n<p>How does a linux machine know what <a href=\"https://www.garykessler.net/library/file_sigs.html\" target=\"_blank\">type</a> of file a <a href=\"https://linux.die.net/man/1/file\" target=\"_blank\">file</a> is?</p>\n<p>You might find this <a href=\"http://www.nongnu.org/ext2-doc/ext2.html\" target=\"_blank\">doc</a> helpful.</p>\n<p>Be careful with <a href=\"https://en.wikipedia.org/wiki/Endianness\" target=\"_blank\">endianness</a> when making edits.</p>\n<p>Once you’ve fixed the corruption, you can use /sbin/<a href=\"https://linux.die.net/man/8/debugfs\" target=\"_blank\">debugfs</a> to pull the flag file out.</p>\n</blockquote>\n<h2 id=\"solution-9\">Solution<a title=\"#solution-9\" href=\"#solution-9\"></a></h2>\n<p>给了一个镜像文件，<code>file</code>命令查看一下，发现不能识别。<code>debugfs</code>可以识别出镜像损坏的部分。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">❯ file ext-super-magic.img</span><br><span class=\"line\">ext-super-magic.img: data</span><br><span class=\"line\"></span><br><span class=\"line\">❯ debugfs ext-super-magic.img</span><br><span class=\"line\">debugfs 1.44.1 (24-Mar-2018)</span><br><span class=\"line\">Checksum errors <span class=\"keyword\">in</span> superblock!  Retrying...</span><br><span class=\"line\">ext-super-magic.img: Bad magic number <span class=\"keyword\">in</span> super-block <span class=\"keyword\">while</span> opening filesystem</span><br></pre></td></tr></table></figure>\n<p>依据提示查看ext2镜像格式的<a href=\"https://wiki.osdev.org/Ext2#Extended_Superblock_Fields\" target=\"_blank\">文档</a>，我们需要在<code>superblock</code>的第56和57字节之间插入<code>magic number</code>，即<code>0xef53</code>。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">❯ file fixed.img</span><br><span class=\"line\">fixed.img: Linux rev 1.0 ext2 filesystem data, UUID=fad5d44e-2bb4-4c22-9410-79b020de84dd (large files)</span><br></pre></td></tr></table></figure>\n<p>修复成功，挂载打开，发现有很多的jpg文件，其中有一张<code>flag.jpg</code>里面就有flag。</p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028014248.png\" alt=\"\" class=\"φcx\"></p>\n<p>flag:<code>picoCTF&#123;a7DB29eCf7dB9960f0A19Fdde9d00Af0&#125;</code></p>\n<h1 id=\"lying-out\">Lying Out<a title=\"#lying-out\" href=\"#lying-out\"></a></h1>\n<h2 id=\"question-10\">Question<a title=\"#question-10\" href=\"#question-10\"></a></h2>\n<blockquote>\n<p>Some odd <a href=\"https://2018shell2.picoctf.com/static/abfdb498b12895694285a032f261c545/traffic.png\" target=\"_blank\">traffic</a> has been detected on the network, can you identify it? More <a href=\"https://2018shell2.picoctf.com/static/abfdb498b12895694285a032f261c545/info.txt\" target=\"_blank\">info</a> here. Connect with <code>nc 2018shell1.picoctf.com 50875</code> to help us answer some questions.</p>\n</blockquote>\n<h3 id=\"hint-10\">Hint<a title=\"#hint-10\" href=\"#hint-10\"></a></h3>\n<p>No Hints.</p>\n<h2 id=\"solution-10\">Solution<a title=\"#solution-10\" href=\"#solution-10\"></a></h2>\n<p>需要分析异常访问流量，对照图片一个个看就可以了。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You<span class=\"string\">&#x27;ll need to consult the file `traffic.png` to answer the following questions.</span></span><br><span class=\"line\"><span class=\"string\">Which of these logs have significantly higher traffic than is usual for their time of day? You can see usual traffic on the attached plot. There may be multiple logs with higher than usual traffic, so answer all of them! Give your answer as a list of `log_ID` values separated by spaces. For example, if you want to answer that logs 2 and 7 are the ones with higher than usual traffic, type 2 7.</span></span><br><span class=\"line\"><span class=\"string\">    log_ID      time  num_IPs</span></span><br><span class=\"line\"><span class=\"string\">0        0  00:00:00     9552</span></span><br><span class=\"line\"><span class=\"string\">1        1  02:30:00    11573</span></span><br><span class=\"line\"><span class=\"string\">2        2  06:00:00    10381</span></span><br><span class=\"line\"><span class=\"string\">3        3  07:00:00    11674</span></span><br><span class=\"line\"><span class=\"string\">4        4  07:00:00    10224</span></span><br><span class=\"line\"><span class=\"string\">5        5  07:30:00    10966</span></span><br><span class=\"line\"><span class=\"string\">6        6  16:00:00     9685</span></span><br><span class=\"line\"><span class=\"string\">7        7  17:45:00    15875</span></span><br><span class=\"line\"><span class=\"string\">8        8  18:00:00    11889</span></span><br><span class=\"line\"><span class=\"string\">9        9  19:15:00    11935</span></span><br><span class=\"line\"><span class=\"string\">10      10  19:30:00    11191</span></span><br><span class=\"line\"><span class=\"string\">11      11  20:30:00     9952</span></span><br><span class=\"line\"><span class=\"string\">12      12  20:45:00     9898</span></span><br><span class=\"line\"><span class=\"string\">13      13  22:45:00    11609</span></span><br><span class=\"line\"><span class=\"string\">1 3 7 13</span></span><br><span class=\"line\"><span class=\"string\">Correct!</span></span><br><span class=\"line\"><span class=\"string\">Great job. You&#x27;</span>ve earned the flag: picoCTF&#123;w4y_0ut_ff5bd19c&#125;</span><br></pre></td></tr></table></figure>\n<p>flag:<code> picoCTF&#123;w4y_0ut_ff5bd19c&#125;</code></p>\n<h1 id=\"what's-my-name?\">What’s My Name?<a title=\"#what's-my-name?\" href=\"#what's-my-name?\"></a></h1>\n<h2 id=\"question-11\">Question<a title=\"#question-11\" href=\"#question-11\"></a></h2>\n<blockquote>\n<p>Say my name, say <a href=\"https://2018shell2.picoctf.com/static/311cab88f8331b8cd1285ae0d90a43f1/myname.pcap\" target=\"_blank\">my name</a>.</p>\n</blockquote>\n<h3 id=\"hint-11\">Hint<a title=\"#hint-11\" href=\"#hint-11\"></a></h3>\n<blockquote>\n<p>If you visited a website at an IP address, how does it know the name of the domain?</p>\n</blockquote>\n<h2 id=\"solution-11\">Solution<a title=\"#solution-11\" href=\"#solution-11\"></a></h2>\n<p>提示给的很明显了，我们需要查找和<code>DNS</code>有关的信息流，在wireshark过滤器中搜寻dns流量，就可以看到flag了。</p>\n<p><img src=\"https://raw.githubusercontent.com/StefanoWen/img/master/img/20181028020752.png\" alt=\"\" class=\"φcx\"></p>\n<p>同样也可以通过字符串搜索的方式找到flag，方法和<code>admin panel</code>一样。</p>\n<h1 id=\"malware-shopscore\">Malware Shopscore<a title=\"#malware-shopscore\" href=\"#malware-shopscore\"></a></h1>\n<blockquote>\n<p>There has been some <a href=\"https://2018shell2.picoctf.com/static/344f0ee2dceb4bde53f90b39a6ad9297/plot.png\" target=\"_blank\">malware</a> detected, can you help with the analysis? More <a href=\"https://2018shell2.picoctf.com/static/344f0ee2dceb4bde53f90b39a6ad9297/info.txt\" target=\"_blank\">info</a> here. Connect with <code>nc 2018shell1.picoctf.com 18874</code>.</p>\n</blockquote>\n<h3 id=\"hint-12\">Hint<a title=\"#hint-12\" href=\"#hint-12\"></a></h3>\n<p>No Hints.</p>\n<h2 id=\"solution-12\">Solution<a title=\"#solution-12\" href=\"#solution-12\"></a></h2>\n<p>还是看图识别数据，和<code>Lying Out</code>差不大多，第一个问题看图片找特征，第二个问题看哪个文件与题目问的文件的<code>jmp_count</code>和<code>add_count</code>的数值相近就选哪个。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You<span class=\"string\">&#x27;ll need to consult the file `clusters.png` to answer the following questions.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">How many attackers created the malware in this dataset?</span></span><br><span class=\"line\"><span class=\"string\">5</span></span><br><span class=\"line\"><span class=\"string\">Correct!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">In the following sample of files from the larger dataset, which file was made by the same attacker who made the file 628e79cf? Indicate your answer by entering that file&#x27;</span>s <span class=\"built_in\">hash</span>.</span><br><span class=\"line\">       <span class=\"built_in\">hash</span>  jmp_count  add_count</span><br><span class=\"line\">0  628e79cf       17.0       18.0</span><br><span class=\"line\">1  1f2c7915       18.0       60.0</span><br><span class=\"line\">2  6e7d554a       10.0       42.0</span><br><span class=\"line\">3  a55f572c       30.0       37.0</span><br><span class=\"line\">4  f118fcd7       36.0       13.0</span><br><span class=\"line\">5  97b1425e       35.0       30.0</span><br><span class=\"line\">6  a163e543       18.0       71.0</span><br><span class=\"line\">7  ebaf5ccd       11.0       18.0</span><br><span class=\"line\">8  9059414f       38.0       13.0</span><br><span class=\"line\">9  c30ea3fe       18.0       37.0</span><br><span class=\"line\">ebaf5ccd</span><br><span class=\"line\">Correct!</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Great job. You<span class=\"string\">&#x27;ve earned the flag: picoCTF&#123;w4y_0ut_dea1794b&#125;</span></span><br></pre></td></tr></table></figure>","prev":{"title":"Vulnhub Raven:2","link":"/Vulnhub-Raven-2"},"next":{"title":"picoCTF2018 Writeup之Cryptography篇","link":"/picoCTF2018-Writeup之Cryptography篇"},"plink":"https://pineswen.tk//picoCTF2018-Writeup之Forensics篇/","toc":[{"id":"前言","title":"前言","index":"1"},{"id":"forensics-warmup-1","title":"Forensics Warmup 1","index":"2","children":[{"id":"question","title":"Question","index":"2.1","children":[{"id":"hint","title":"Hint","index":"2.1.1"}]},{"id":"solution","title":"Solution","index":"2.2"}]},{"id":"forensics-warmup-2","title":"Forensics Warmup 2","index":"3","children":[{"id":"question-1","title":"Question","index":"3.1","children":[{"id":"hint-1","title":"Hint","index":"3.1.1"}]},{"id":"solution-1","title":"Solution","index":"3.2"}]},{"id":"desrouleaux","title":"Desrouleaux","index":"4","children":[{"id":"question-2","title":"Question","index":"4.1","children":[{"id":"hint-2","title":"Hint","index":"4.1.1"}]},{"id":"solution-2","title":"Solution","index":"4.2"}]},{"id":"reading-between-the-eyes","title":"Reading Between the Eyes","index":"5","children":[{"id":"question-3","title":"Question","index":"5.1","children":[{"id":"hint-3","title":"Hint","index":"5.1.1"}]},{"id":"solution-3","title":"Solution","index":"5.2"}]},{"id":"recovering-from-the-snap","title":"Recovering From the Snap","index":"6","children":[{"id":"question-4","title":"Question","index":"6.1","children":[{"id":"hint-4","title":"Hint","index":"6.1.1"}]},{"id":"solution-4","title":"Solution","index":"6.2"}]},{"id":"admin-panel","title":"admin panel","index":"7","children":[{"id":"question-5","title":"Question","index":"7.1","children":[{"id":"hint-5","title":"Hint","index":"7.1.1"}]},{"id":"solution-5","title":"Solution","index":"7.2"}]},{"id":"hex-editor","title":"hex editor","index":"8","children":[{"id":"question-6","title":"Question","index":"8.1","children":[{"id":"hint-6","title":"Hint","index":"8.1.1"}]},{"id":"solution-6","title":"Solution","index":"8.2"}]},{"id":"truly-an-artist","title":"Truly an Artist","index":"9","children":[{"id":"question-7","title":"Question","index":"9.1","children":[{"id":"hint-7","title":"Hint","index":"9.1.1"}]},{"id":"solution-7","title":"Solution","index":"9.2"}]},{"id":"now-you-don't","title":"now you don’t","index":"10","children":[{"id":"question-8","title":"Question","index":"10.1","children":[{"id":"hint-8","title":"Hint","index":"10.1.1"}]},{"id":"solution-8","title":"Solution","index":"10.2"}]},{"id":"ext-super-magic","title":"Ext Super Magic","index":"11","children":[{"id":"question-9","title":"Question","index":"11.1","children":[{"id":"hint-9","title":"Hint","index":"11.1.1"}]},{"id":"solution-9","title":"Solution","index":"11.2"}]},{"id":"lying-out","title":"Lying Out","index":"12","children":[{"id":"question-10","title":"Question","index":"12.1","children":[{"id":"hint-10","title":"Hint","index":"12.1.1"}]},{"id":"solution-10","title":"Solution","index":"12.2"}]},{"id":"what's-my-name?","title":"What’s My Name?","index":"13","children":[{"id":"question-11","title":"Question","index":"13.1","children":[{"id":"hint-11","title":"Hint","index":"13.1.1"}]},{"id":"solution-11","title":"Solution","index":"13.2"}]},{"id":"malware-shopscore","title":"Malware Shopscore","index":"14","children":[{"id":"hint-12","title":"Hint","index":"14.1"}]},{"id":"solution-12","title":"Solution","index":"15"}]}